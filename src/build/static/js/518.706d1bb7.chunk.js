"use strict";(self.webpackChunkstudent_typescript=self.webpackChunkstudent_typescript||[]).push([[518],{83518:(e,t,i)=>{i.r(t),i.d(t,{GuestUser:()=>ne,default:()=>se});var n=i(24836),s=i(96446),l=i(25754),r=i(60587),d=i(85865),o=i(88911),a=i(11906),c=i(90035),u=i(65043),v=i(29378),p=i(68903),h=i(12110),x=i(74354),g=i(81637),m=i(67784),f=i(54536),y=i(88340),j=i(99380),A=i(55797),b=i(54712),_=i(18723),w=i(66748),S=i(33438),k=i(78619),C=i(87977),M=i(70579);const F=e=>{let{content:t}=e;const i=C.A.sanitize(t);return(0,M.jsx)(k.o,{components:{a:e=>{let{href:t,children:i,...n}=e;return(0,M.jsx)("a",{href:t,target:"_blank",rel:"noopener noreferrer",...n,children:i})}},children:i})};var I=i(86651),R=i(61610);const N=u.forwardRef((function(e,t){return(0,M.jsx)(n.A,{direction:"up",ref:t,...e})})),T=e=>{let{open:t,setOpen:i,id:n,type:l}=e;const h=(0,v.G)((e=>e.sharedInfo)),k=(0,v.G)((e=>e.BlockedList)),C=(0,u.useRef)([]),[T,z]=(0,u.useState)(!1),B=(0,v.G)((e=>e.messages)),[P,O]=(0,u.useState)([]),[E,D]=(0,u.useState)(null),[H,G]=(0,u.useState)(!1),[W,L]=(0,u.useState)(""),[V,U]=(0,u.useState)(!1),[q,Y]=(0,u.useState)(""),K=(0,v.G)((e=>{let t=e.chats;return"advisors"===l?t.data.advisors.find((e=>e._id===n)):t.data.community.find((e=>e._id===n))})),Z=(0,v.j)(),J=null===K||void 0===K?void 0:K.participants.find((e=>{var t;return e._id!==(null===h||void 0===h||null===(t=h.data)||void 0===t?void 0:t._id)})),Q=async()=>{const e=await(0,A.de)(n);if(e.success&&(Z((0,_.wi)(e.data)),h.data&&h.data._id&&Object.values(h.data).every((e=>void 0!==typeof e)))){let t={action:"seen",sender:{...h.data,userType:"student"},recievers:null===K||void 0===K?void 0:K.participants.filter((e=>{var t;return e._id!==(null===(t=h.data)||void 0===t?void 0:t._id)})),data:e.data};w.A.emit("trigger",t)}},X=e=>{if("send"===e.action)Z((0,b.tj)({...e.data.message,type:"normal"})),Q()},$=async e=>{let t;switch(e.name){case"send":const l=new FormData;if(!e.data.trim()&&0===P.length)return void console.error("No message content or valid files to upload.");l.append("content",e.data),l.append("chatId",n);let r=0;if(P.length>0){const t=["image/jpeg","image/jpg","image/png","application/pdf","application/msword","application/vnd.openxmlformats-officedocument.wordprocessingml.document"],i=P.filter((e=>{const i=t.includes(null===e||void 0===e?void 0:e.type),n=(null===e||void 0===e?void 0:e.size)<=16777216;return i&&n}));if(0===i.length&&!e.data)return;if(i.forEach((e=>{l.append("uploaded_file",e),r+=e.size})),0===i.length&&!e.data.trim())return void console.error("No valid files selected and no message content.")}try{if(e.data.trim()||r>0){const e=await(0,A._N)(l);if(e.data.success){Z((0,_.wi)(e.data.data.chat)),Z((0,b.tj)(e.data.data.message));const t={action:"send",sender:{...h.data,userType:"student"},recievers:null===K||void 0===K?void 0:K.participants.filter((e=>{var t;return e._id!==(null===(t=h.data)||void 0===t?void 0:t._id)})),data:e.data.data};w.A.emit("trigger",t),O([])}else console.error("Failed to send message or upload files.")}}catch(i){console.error("Error during file upload or message sending:",i)}break;case"startTyping":t={action:"typing",sender:{...h.data,userType:"student"},recievers:null===K||void 0===K?void 0:K.participants.filter((e=>{var t;return e._id!=(null===(t=h.data)||void 0===t?void 0:t._id)})),data:"start"},w.A.emit("trigger",t);break;case"stopTyping":t={action:"typing",sender:{...h.data,userType:"student"},recievers:null===K||void 0===K?void 0:K.participants.filter((e=>{var t;return e._id!=(null===(t=h.data)||void 0===t?void 0:t._id)})),data:"stop"},w.A.emit("trigger",t);break;case"block":try{const t=await(0,A.wy)(q,e.data.id);Z("block"===q?(0,R.EP)(t.data.data.blocked):(0,R.Rf)(t.data.data.blocked._id))}catch(s){console.log(s)}}};(0,u.useEffect)((()=>(w.A.removeListener("trigger",X),w.A.on("trigger",X),(async()=>{try{z(!0);const e=await(0,A.qH)(n);if(e){let t=e.data.map((e=>({...e,type:"normal"})));t.reverse(),Z((0,b.bq)({requestStatus:"initiated",responseStatus:"recieved",haveAnIssue:!1,issue:"",data:t})),0!=(null===K||void 0===K?void 0:K.unSeenMessages.filter((e=>{var t;return e.message.sender._id!==(null===(t=h.data)||void 0===t?void 0:t._id)})).filter((e=>!e.seen.find((e=>{var t;return e===(null===(t=h.data)||void 0===t?void 0:t._id)})))).length)&&await Q()}z(!1)}catch(e){}z(!1)})(),()=>{w.A.removeListener("trigger",X)})),[]),C.current=K&&h.data?((e,t,i)=>{let n=t.participants.filter((e=>e._id!=i._id)),s=[],l=[];e.reverse(),e.forEach((e=>{var r;if((null===(r=e.sender)||void 0===r?void 0:r._id)==i._id)if(0!=n.length){if(0==t.unSeenMessages.length?0!=n.length&&(l=[...n]):l=t.unSeenMessages.find((t=>t.message._id==e._id))?n.filter((i=>{var n;return null===(n=t.unSeenMessages.find((t=>t.message._id==e._id)))||void 0===n?void 0:n.seen.find((e=>e==i._id))})):[...n],0!=l.length){let i=l.reduce(((e,t)=>e+t.firstName+" , "),"Seen by ");s.push({_id:e._id+"_seen",type:"seen",content:i.substring(0,i.length-3),chat:t._id})}s.push(e),n=n.filter((e=>!l.find((t=>t._id==e._id))))}else s.push(e);else s.push(e)})),s.reverse();let r=t.participants.filter((e=>"typing"==e.activity));if(0!=r.length){let e=r.reduce(((e,t)=>t.firstName+" , "),"");s.push({_id:t._id+"_typing",type:"typing",content:e.substring(0,e.length-3)+(1==r.length?" is typing":" are typing"),chat:t._id,sender:{displayPicSrc:"",firstName:"",lastName:"",email:"",_id:t._id+"_typing",userType:""}})}return s})([...B.data],K,h.data):[];const ee=e=>(0,M.jsx)("div",{style:{background:"#F8F8FC",padding:"0.5rem",borderRadius:"0.8rem",position:"relative"},children:(0,M.jsxs)(o.A,{direction:"row",spacing:2,alignItems:"center",justifyContent:"space-between",children:[(0,M.jsxs)(s.A,{sx:{display:"flex",gap:"1rem",alignItems:"center"},children:[(0,M.jsx)(r.A,{src:"Virtual_Assistant"===(null===J||void 0===J?void 0:J.role)?y.A.ai:null===J||void 0===J?void 0:J.displayPicSrc,alt:"profile",sx:{width:"3rem",height:"3rem",borderRadius:"50%"}}),(0,M.jsx)(d.A,{fontWeight:"500",sx:{position:"absolute",right:"10px",top:"-1rem",background:"#fff",p:1,borderRadius:"10px",color:"counsellor"===(null===J||void 0===J?void 0:J.role)?"#3B3F76":"processCoordinator"===(null===J||void 0===J?void 0:J.role)?"#569228":"#FEB853",fontSize:"14px"},children:null!==J&&void 0!==J&&J.role?(0,x.AZ)(null===J||void 0===J?void 0:J.role):null===J||void 0===J?void 0:J.role}),(0,M.jsx)(s.A,{children:null!==J&&void 0!==J&&J.firstName||null!==J&&void 0!==J&&J.lastName?(0,M.jsxs)(d.A,{fontWeight:"500",children:[(0,x.r0)(null===J||void 0===J?void 0:J.firstName),"\xa0",(0,x.r0)(null===J||void 0===J?void 0:J.lastName)]}):(0,M.jsx)(d.A,{children:"User"})})]}),"member"!==(null===J||void 0===J?void 0:J.userType)&&(0,M.jsx)(s.A,{sx:{float:"right"},children:(0,M.jsx)(a.A,{sx:{textTransform:"none",color:"#3b3f76",float:"right"},onClick:()=>{const t=k.data.some((e=>(null===e||void 0===e?void 0:e._id)===(null===J||void 0===J?void 0:J._id)));Y(t?"unblock":"block"),e.setBlockOpen(!0)},children:k.data.some((e=>(null===e||void 0===e?void 0:e._id)===(null===J||void 0===J?void 0:J._id)))?"Unblock":"Block"})})]})}),te=()=>{const e=(0,u.useRef)(null),t=(0,u.useRef)(null),[i,n]=(0,u.useState)(!0);return(0,u.useEffect)((()=>{var t;i&&(null===(t=e.current)||void 0===t||t.scrollIntoView({behavior:"auto"}))}),[C.current]),(0,u.useEffect)((()=>{var t;null===(t=e.current)||void 0===t||t.scrollIntoView({behavior:"auto"})}),[]),(0,M.jsxs)(s.A,{ref:t,onScroll:()=>{if(t.current){const{scrollTop:e,scrollHeight:i,clientHeight:s}=t.current;n(i-e-s<=5)}},sx:{overflowY:"scroll",mt:3,height:"390px","&::-webkit-scrollbar":{width:"12px"},"&::-webkit-scrollbar-thumb":{backgroundColor:"transparent",borderRadius:"8px"}},children:[T?(0,M.jsx)(s.A,{sx:{display:"flex",justifyContent:"center",alignItems:"center",height:"300px"},children:(0,M.jsx)(g.A,{})}):(0,M.jsx)("div",{className:"chat-container",children:C.current.length>0?(0,M.jsxs)(M.Fragment,{children:[C.current.map((e=>{var t,i,n,s,l,d,o,a,c;return(0,M.jsx)(M.Fragment,{children:"seen"!==e.type&&"typing"!==e.type?(0,M.jsxs)("div",{className:"message ".concat((null===e||void 0===e||null===(t=e.sender)||void 0===t?void 0:t._id)===(null===(i=h.data)||void 0===i?void 0:i._id)?"sent":"received"),children:[(0,M.jsx)(F,{content:e.content}),null!==e&&void 0!==e&&null!==(n=e.document)&&void 0!==n&&null!==(s=n.data)&&void 0!==s&&s.preview_url?(0,M.jsx)("iframe",{src:null===e||void 0===e||null===(l=e.document)||void 0===l||null===(d=l.data)||void 0===d?void 0:d.preview_url,title:"preview",style:{border:"none",width:"150px",height:"150px",objectFit:"contain"}}):"",(0,M.jsx)(r.A,{src:null===(o=e.sender)||void 0===o?void 0:o.displayPicSrc,alt:"",sx:(null===e||void 0===e||null===(a=e.sender)||void 0===a?void 0:a._id)===(null===(c=h.data)||void 0===c?void 0:c._id)?{width:"1.5rem",height:"1.5rem",borderRadius:"50%",position:"absolute",top:"-12px",right:0}:{width:"1.5rem",height:"1.5rem",borderRadius:"50%",position:"absolute",top:"-12px",left:0}})]},e._id):(0,M.jsx)("div",{className:"seenMsg",children:e.content})})})),(0,M.jsx)("div",{ref:e}),"          "]}):J?(0,M.jsx)(d.A,{textAlign:"center",children:"Start chat"}):(0,M.jsx)(d.A,{textAlign:"center",children:"No chat"})}),"  ",k.data.some((e=>(null===e||void 0===e?void 0:e._id)===(null===J||void 0===J?void 0:J._id)))&&(0,M.jsx)(d.A,{textAlign:"center",fontSize:"0.9rem",children:"You blocked this member."})]})},ie=e=>{const[t,n]=(0,u.useState)(""),[s,l]=(0,u.useState)(!1),r=(0,u.useRef)(null),o=async()=>{try{""!==t.trim()||P&&P.length>0?(l(!0),i(!0),await e.eventHandler({name:"send",data:t})):console.log("No content or files to send.")}catch(n){console.error("Error while sending:",n)}finally{l(!1)}};return(0,M.jsx)(M.Fragment,{children:J&&(0,M.jsxs)("div",{style:{position:"relative"},children:[(null===P||void 0===P?void 0:P.length)>0&&(0,M.jsx)("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",position:"absolute",top:"-44px",right:"35%"},children:(0,M.jsxs)("div",{style:{width:"fitContent"},children:[(0,M.jsx)(d.A,{fontSize:"0.9rem",children:"Selected files:"}),(0,M.jsx)("ul",{style:{listStyle:"none",padding:0,margin:0},children:P.map(((e,t)=>(0,M.jsxs)("li",{style:{fontSize:"12px",display:"flex"},children:[e.name,(0,M.jsx)(S.A,{onClick:()=>(e=>{const t=[...P];t.splice(e,1),O(t)})(t),sx:{fontSize:"1rem",cursor:"pointer"}})]},t)))})]})}),H?(0,M.jsx)("div",{className:"replyDiv",children:(0,M.jsxs)("h5",{children:["reply to:- ",W]})}):"",k.data.some((e=>(null===e||void 0===e?void 0:e._id)===(null===J||void 0===J?void 0:J._id)))?"":(0,M.jsxs)(p.Ay,{container:!0,sx:{background:"#F8F8FC",padding:"0.5rem",borderRadius:"0.8rem"},children:[(0,M.jsx)(p.Ay,{item:!0,xs:1,sx:{display:"flex",justifyContent:"center",alignItems:"center"},children:(0,M.jsxs)("div",{children:[(0,M.jsx)("input",{type:"file",multiple:!0,style:{display:"none"},onChange:e=>{const t=Array.from(e.target.files);O(t)},ref:r}),(0,M.jsx)(j.A,{sx:{color:"",cursor:"pointer"},onClick:()=>{var e;return null===r||void 0===r||null===(e=r.current)||void 0===e?void 0:e.click()}})]})}),(0,M.jsx)(p.Ay,{item:!0,xs:9.5,children:(0,M.jsx)(m.A,{variant:"outlined",size:"small",onFocus:()=>e.eventHandler({name:"startTyping"}),onBlur:()=>e.eventHandler({name:"stopTyping"}),multiline:!0,rows:2,fullWidth:!0,value:t,placeholder:"Type your message...",sx:{"& .MuiOutlinedInput-notchedOutline":{border:0,"&:Focus":{border:0}},"& .Mui-focused .MuiOutlinedInput-notchedOutline":{border:"none !important"}},onChange:e=>n(e.target.value),onKeyDown:e=>{"Enter"!==e.key||e.shiftKey||""===t.trim()||(e.preventDefault(),o())}})}),(0,M.jsx)(p.Ay,{item:!0,xs:1.5,sx:{display:"flex",justifyContent:"center",alignItems:"center",background:"#fff",borderRadius:"6px"},children:s?(0,M.jsx)("img",{src:y.A.standardLoader,alt:"loader",style:{width:"1rem"}}):(0,M.jsx)("img",{src:y.A.sendIcon,alt:"sendIcon",style:{width:"2rem",height:"2rem"},onClick:o})})]})]})})};return(0,M.jsxs)("div",{children:[(0,M.jsxs)(c.A,{open:t,sx:{right:"0",left:{md:"45%",xs:"0",lg:"68%"},top:{md:"10px",xs:"0",lg:"25px"}},PaperProps:{style:{borderRadius:"1rem",padding:"1rem",width:"410px",height:"582px"}},TransitionComponent:N,keepMounted:!0,onClose:()=>i(!1),"aria-describedby":"alert-dialog-slide-description",children:[(0,M.jsx)(s.A,{sx:{display:"flex",alignItems:"center",justifyContent:"center"},children:(0,M.jsx)(f.A,{sx:{position:"absolute",top:0,color:"#0F0F0F",fontSize:"2rem",cursor:"pointer",display:"flex",justifyContent:"center",alignItems:"center"},onClick:()=>i(!1)})}),(0,M.jsxs)(s.A,{sx:{mt:3},children:[(0,M.jsx)(ee,{eventHandler:$,setBlockOpen:U}),(0,M.jsx)(te,{}),(0,M.jsx)(ie,{eventHandler:$})]})]}),(0,M.jsx)(I.A,{open:V,handleClose:()=>U(!1),additionalData:{onSubmit:()=>$({name:"block",data:{id:null===J||void 0===J?void 0:J._id}}),title:"Are you sure you want to ".concat(q," this user?"),content:""}})]})};var z=i(53253),B=i(13383);const P=e=>{var t;const[i,n]=(0,u.useState)(!1),l=(0,v.G)((e=>e.sharedInfo)),o=null===l||void 0===l?void 0:l.data,a=o?((e,t)=>{var i,n,s;let l={dp:"",name:"",unseenMessages:0,activeParticipants:[],chatType:"1-1",lastMessage:void 0,role:""},r=null===e||void 0===e||null===(i=e.participants)||void 0===i?void 0:i.find((e=>e._id===t._id)),d=null===e||void 0===e||null===(n=e.participants)||void 0===n?void 0:n.filter((e=>e._id!==t._id));var o,a,c,u,v,p;(null===e||void 0===e||null===(s=e.participants)||void 0===s?void 0:s.length)<=2?(l.name=(null===d||void 0===d?void 0:d.length)>0?(null!==d&&void 0!==d&&null!==(o=d[0])&&void 0!==o&&o.firstName?null===d||void 0===d||null===(a=d[0])||void 0===a?void 0:a.firstName:"user")+(null!==d&&void 0!==d&&null!==(c=d[0])&&void 0!==c&&c.lastName?" "+(null===d||void 0===d||null===(u=d[0])||void 0===u?void 0:u.lastName):""):"Deleted User",l.dp=(null===d||void 0===d?void 0:d.length)>0?null===d||void 0===d||null===(v=d[0])||void 0===v?void 0:v.displayPicSrc:"",l.role=(null===d||void 0===d?void 0:d.length)>0?null===d||void 0===d||null===(p=d[0])||void 0===p?void 0:p.role:""):(l.chatType="group",l.name="Group Name");return l.unseenMessages=e.unSeenMessages.filter((e=>{var i,n;return(null===(i=e.message)||void 0===i||null===(n=i.sender)||void 0===n?void 0:n._id)!==(null===t||void 0===t?void 0:t._id)})).filter((e=>!e.seen.some((e=>e===t._id)))).length,e.lastMessage&&r&&(l.lastMessage=((e,t)=>{var i,n,s;let l={sender:(null===(i=e.lastMessage)||void 0===i?void 0:i.sender)===t._id?"current":"others",message:null!==(n=e.lastMessage)&&void 0!==n&&n.content?null===(s=e.lastMessage)||void 0===s?void 0:s.content:"",status:"seen"};if("current"===l.sender)l.status=-1===e.unSeenMessages.findIndex((t=>{var i;return t.message._id===(null===(i=e.lastMessage)||void 0===i?void 0:i._id)}))?"seen":"unseen";else{let i=e.unSeenMessages.findIndex((t=>{var i;return t.message._id===(null===(i=e.lastMessage)||void 0===i?void 0:i._id)}));l.status=-1===i?"seen":-1===e.unSeenMessages[i].seen.findIndex((e=>e===t._id))?"unseen":"seen"}return l})(e,r),l.activeParticipants=((e,t)=>{let i=e.participants.filter((e=>"inchat"===e.activity&&e._id!==t._id)),n=e.participants.filter((e=>"online"===e.activity&&e._id!==t._id));return[...e.participants.filter((e=>"typing"===e.activity&&e._id!==t._id)),...i,...n]})(e,r)),l})(e.data,o):null,c=()=>{var e,t,i,n,l,r,o,c;return(0,M.jsxs)("div",{style:{display:"flex",gap:"8px",width:"100%"},children:["current"===(null===a||void 0===a||null===(e=a.lastMessage)||void 0===e?void 0:e.sender)?(0,M.jsx)(M.Fragment,{children:"seen"===(null===a||void 0===a||null===(t=a.lastMessage)||void 0===t?void 0:t.status)?(0,M.jsx)(s.A,{sx:{display:"flex"},children:(0,M.jsx)(z.A,{sx:{color:"#2196f3",fontSize:"1rem"}})}):(0,M.jsx)(s.A,{sx:{display:"flex"},children:(0,M.jsx)(z.A,{sx:{color:"gray",fontSize:"1rem"}})})}):null,(0,M.jsxs)(d.A,{sx:{fontSize:"12px",width:"200px",height:"2rem",textOverflow:"ellipsis",whiteSpace:"nowrap",overflow:"hidden",fontWeight:"current"===(null===a||void 0===a||null===(i=a.lastMessage)||void 0===i?void 0:i.sender)||"seen"===(null===a||void 0===a||null===(n=a.lastMessage)||void 0===n?void 0:n.status)?"300":"600",color:"current"===(null===a||void 0===a||null===(l=a.lastMessage)||void 0===l?void 0:l.sender)||"seen"===(null===a||void 0===a||null===(r=a.lastMessage)||void 0===r?void 0:r.status)?"#98999A":"#000"},children:[null===a||void 0===a||null===(o=a.lastMessage)||void 0===o?void 0:o.message,(0,M.jsx)(d.A,{fontWeight:"400",color:"#000",fontSize:"0.8rem",children:null!==a&&void 0!==a&&null!==(c=a.lastMessage)&&void 0!==c&&c.message?"":"Tap to chat"})]})]})};return(0,M.jsxs)("div",{style:{position:"relative"},children:[(0,M.jsx)(h.A,{sx:{pl:1,background:"#F8F8FC",borderRadius:"10px",boxShadow:0,cursor:"pointer"},onClick:()=>n(!0),children:(0,M.jsxs)(p.Ay,{container:!0,spacing:2,children:[(0,M.jsxs)(p.Ay,{item:!0,xs:2,sx:{display:"flex",justifyContent:"center",alignItems:"center",position:"relative"},children:[(0,M.jsx)(r.A,{src:"Virtual_Assistant"===(null===a||void 0===a?void 0:a.role)?y.A.ai:null===a||void 0===a?void 0:a.dp,alt:"logo",style:{width:"2.5rem",height:"2.5rem",borderRadius:"50%",marginLeft:"0.8rem"}}),"1-1"===(null===a||void 0===a?void 0:a.chatType)&&0!==(null===a||void 0===a?void 0:a.activeParticipants.length)&&"offline"!==(null===a||void 0===a?void 0:a.activeParticipants[0].activity)?(0,M.jsx)(B.A,{sx:{color:"green",fontSize:"1rem",position:"absolute",bottom:"10px",right:"-7px"}}):null]}),(0,M.jsxs)(p.Ay,{item:!0,xs:8,sx:{mt:1},children:[(0,M.jsx)(d.A,{fontWeight:"500",gutterBottom:!0,children:(0,x.r0)(null===a||void 0===a?void 0:a.name)}),"Deleted User"===(null===a||void 0===a?void 0:a.name)?(0,M.jsx)(s.A,{sx:{p:1}}):(0,M.jsx)(c,{})]}),(0,M.jsx)(p.Ay,{item:!0,xs:2,sx:{display:"flex",justifyContent:"center",alignItems:"center"},children:(0,M.jsx)(d.A,{sx:{background:"#3b3f76",color:"#fff",borderRadius:"50%",width:"1rem",height:"1rem",border:"1px solid #3B3F76",fontSize:"11px",textAlign:"center"},children:null===a||void 0===a?void 0:a.unseenMessages})}),(0,M.jsx)(p.Ay,{item:!0,xs:12,sx:{position:"absolute",right:"10px",top:"-2rem"},children:(0,M.jsx)(d.A,{fontWeight:"500",sx:{background:"#fff",p:.5,borderRadius:"10px",color:"counsellor"===(null===a||void 0===a?void 0:a.role)?"#3B3F76":"processCoordinator"===(null===a||void 0===a?void 0:a.role)?"#569228":"#FEB853",fontSize:"14px"},children:null!==a&&void 0!==a&&a.role?(0,x.AZ)(null===a||void 0===a?void 0:a.role):null===a||void 0===a?void 0:a.role})})]})}),i?(0,M.jsx)(T,{open:i,setOpen:n,id:null===e||void 0===e||null===(t=e.data)||void 0===t?void 0:t._id,type:"advisors"}):null]})},O=()=>{var e,t,i;const n=(0,v.G)((e=>e.chats)),l=null===(r=null===n||void 0===n||null===(e=n.data)||void 0===e?void 0:e.advisors)||void 0===r?void 0:r.filter((e=>{var t;return!(null!==e&&void 0!==e&&null!==(t=e.participants)&&void 0!==t&&t.some((e=>"Virtual_Assistant"===e.role)))}));var r;return(0,M.jsx)(s.A,{sx:{overflowY:"scroll",height:"450px","&::-webkit-scrollbar":{width:"12px"},"&::-webkit-scrollbar-thumb":{backgroundColor:"#fff",borderRadius:"8px"},"&::-webkit-scrollbar-track":{backgroundColor:"#fff"},width:"100%",mt:1},children:(0,M.jsx)(p.Ay,{container:!0,spacing:2,sx:{mt:0},children:(null===n||void 0===n||null===(t=n.data)||void 0===t||null===(i=t.advisors)||void 0===i?void 0:i.length)>0?null===l||void 0===l?void 0:l.map(((e,t)=>(0,M.jsx)(p.Ay,{item:!0,xs:12,children:(0,M.jsx)(P,{data:e})},t))):(0,M.jsx)(s.A,{sx:{height:"5rem",borderRadius:"20px",display:"flex",justifyContent:"center",alignItems:"center",width:"100%"},children:(0,M.jsx)(d.A,{color:"#3B3F76",children:"Start a new chat"})})})})},E=e=>{var t;const[i,n]=(0,u.useState)(!1),l=(0,v.G)((e=>e.sharedInfo)),o=null===l||void 0===l?void 0:l.data,a=o?((e,t)=>{let i={dp:"",name:"",unseenMessages:0,activeParticipants:[],chatType:"1-1",lastMessage:void 0},n=e.participants.find((e=>e._id===t._id)),s=e.participants.filter((e=>e._id!==t._id));var l,r,d,o;e.participants.length<=2?(i.name=(null===s||void 0===s?void 0:s.length)>0?(null!==s&&void 0!==s&&null!==(l=s[0])&&void 0!==l&&l.firstName?null===s||void 0===s||null===(r=s[0])||void 0===r?void 0:r.firstName:"user")+(null!==s&&void 0!==s&&null!==(d=s[0])&&void 0!==d&&d.lastName?" "+(null===s||void 0===s||null===(o=s[0])||void 0===o?void 0:o.lastName):""):"Deleted User",i.dp=(null===s||void 0===s?void 0:s.length)>0?null===s||void 0===s?void 0:s[0].displayPicSrc:""):(i.chatType="group",i.name="Group Name");return i.unseenMessages=e.unSeenMessages.filter((e=>{var i,n;return(null===e||void 0===e||null===(i=e.message)||void 0===i||null===(n=i.sender)||void 0===n?void 0:n._id)!==(null===t||void 0===t?void 0:t._id)})).filter((e=>!e.seen.some((e=>e===t._id)))).length,e.lastMessage&&n&&(i.lastMessage=((e,t)=>{var i,n,s;let l={sender:(null===(i=e.lastMessage)||void 0===i?void 0:i.sender)===t._id?"current":"others",message:null!==(n=e.lastMessage)&&void 0!==n&&n.content?null===(s=e.lastMessage)||void 0===s?void 0:s.content:"",status:"seen"};if("current"===l.sender)l.status=-1===e.unSeenMessages.findIndex((t=>{var i;return t.message._id===(null===(i=e.lastMessage)||void 0===i?void 0:i._id)}))?"seen":"unseen";else{let i=e.unSeenMessages.findIndex((t=>{var i;return t.message._id===(null===(i=e.lastMessage)||void 0===i?void 0:i._id)}));l.status=-1===i?"seen":-1===e.unSeenMessages[i].seen.findIndex((e=>e===t._id))?"unseen":"seen"}return l})(e,n),i.activeParticipants=((e,t)=>{let i=e.participants.filter((e=>"inchat"===e.activity&&e._id!==t._id)),n=e.participants.filter((e=>"online"===e.activity&&e._id!==t._id));return[...e.participants.filter((e=>"typing"===e.activity&&e._id!==t._id)),...i,...n]})(e,n)),i})(e.data,o):null,c=()=>{var e,t,i,n,l,r,o,c;return(0,M.jsxs)("div",{style:{display:"flex",gap:"8px",width:"100%"},children:["current"===(null===a||void 0===a||null===(e=a.lastMessage)||void 0===e?void 0:e.sender)?(0,M.jsx)(M.Fragment,{children:"seen"===(null===a||void 0===a||null===(t=a.lastMessage)||void 0===t?void 0:t.status)?(0,M.jsx)(s.A,{sx:{display:"flex"},children:(0,M.jsx)(z.A,{sx:{color:"#2196f3",fontSize:"1rem"}})}):(0,M.jsx)(s.A,{sx:{display:"flex"},children:(0,M.jsx)(z.A,{sx:{color:"gray",fontSize:"1rem"}})})}):null,(0,M.jsxs)(d.A,{sx:{fontSize:"12px",width:"200px",height:"2rem",textOverflow:"ellipsis",whiteSpace:"nowrap",overflow:"hidden",fontWeight:"current"===(null===a||void 0===a||null===(i=a.lastMessage)||void 0===i?void 0:i.sender)||"seen"===(null===a||void 0===a||null===(n=a.lastMessage)||void 0===n?void 0:n.status)?"300":"400",color:"current"===(null===a||void 0===a||null===(l=a.lastMessage)||void 0===l?void 0:l.sender)||"seen"===(null===a||void 0===a||null===(r=a.lastMessage)||void 0===r?void 0:r.status)?"#98999A":"#000"},children:[null===a||void 0===a||null===(o=a.lastMessage)||void 0===o?void 0:o.message,(0,M.jsx)(d.A,{fontWeight:"400",color:"#000",fontSize:"0.8rem",children:null!==a&&void 0!==a&&null!==(c=a.lastMessage)&&void 0!==c&&c.message?"":"Tap to chat"})]})]})};return(0,M.jsxs)("div",{children:[(0,M.jsx)(h.A,{sx:{p:.5,background:"#F8F8FC",borderRadius:"10px",boxShadow:0,cursor:"pointer"},onClick:()=>n(!0),children:(0,M.jsxs)(p.Ay,{container:!0,spacing:2,children:[(0,M.jsxs)(p.Ay,{item:!0,xs:2,sx:{display:"flex",justifyContent:"center",alignItems:"center",position:"relative"},children:[(0,M.jsx)(r.A,{src:null===a||void 0===a?void 0:a.dp,alt:"logo",style:{width:"2.5rem",height:"2.5rem",borderRadius:"50%",marginLeft:"0.8rem"}}),"1-1"===(null===a||void 0===a?void 0:a.chatType)&&0!==(null===a||void 0===a?void 0:a.activeParticipants.length)&&"offline"!==(null===a||void 0===a?void 0:a.activeParticipants[0].activity)?(0,M.jsx)(B.A,{sx:{color:"green",fontSize:"1rem",position:"absolute",bottom:"10px",right:"-7px"}}):null]}),(0,M.jsxs)(p.Ay,{item:!0,xs:8,children:[(0,M.jsx)(d.A,{fontWeight:"500",gutterBottom:!0,children:(0,x.r0)(null===a||void 0===a?void 0:a.name)}),"Deleted User"===(null===a||void 0===a?void 0:a.name)?(0,M.jsx)(s.A,{sx:{p:1}}):(0,M.jsx)(c,{})]}),(0,M.jsx)(p.Ay,{item:!0,xs:2,sx:{display:"flex",justifyContent:"center",alignItems:"center"},children:(0,M.jsx)(d.A,{sx:{background:"#3B3F76",color:"#fff",borderRadius:"50%",width:"1rem",height:"1rem",border:"1px solid #3B3F76",fontSize:"11px",textAlign:"center"},children:null===a||void 0===a?void 0:a.unseenMessages})})]})}),i?(0,M.jsx)(T,{open:i,setOpen:n,id:null===e||void 0===e||null===(t=e.data)||void 0===t?void 0:t._id,type:"community"}):null]})},D=()=>{var e,t,i,n;const l=(0,v.G)((e=>e.chats));return(0,M.jsx)(s.A,{sx:{overflowY:"scroll",height:"450px","&::-webkit-scrollbar":{width:"12px"},"&::-webkit-scrollbar-thumb":{backgroundColor:"#fff",borderRadius:"8px"},"&::-webkit-scrollbar-track":{backgroundColor:"#fff"},width:"100%",mt:2},children:(0,M.jsx)(p.Ay,{container:!0,spacing:2,sx:{mt:0},children:(null===l||void 0===l||null===(e=l.data)||void 0===e||null===(t=e.community)||void 0===t?void 0:t.length)>0?null===l||void 0===l||null===(i=l.data)||void 0===i||null===(n=i.community)||void 0===n?void 0:n.map(((e,t)=>(0,M.jsx)(p.Ay,{item:!0,xs:12,children:(0,M.jsx)(E,{data:e})},t))):(0,M.jsx)(s.A,{sx:{height:"5rem",borderRadius:"20px",display:"flex",justifyContent:"center",alignItems:"center",width:"100%"},children:(0,M.jsx)(d.A,{color:"#3B3F76",children:"Start a new chat"})})})})};var H=i(22505),G=i(84311),W=i(8064),L=i(51787),V=i(66360),U=i(57566);const q=u.forwardRef((function(e,t){return(0,M.jsx)(n.A,{direction:"up",ref:t,...e})})),Y=e=>{let{eventHandler:t,options:i,friends:n}=e;return(0,M.jsxs)(o.A,{spacing:1,className:"chat-container-messenger1",sx:{mt:2,height:"480px"},children:[(0,M.jsx)(d.A,{textAlign:"center",fontWeight:"600",children:"New Chat"}),(0,M.jsx)(m.A,{size:"small",fullWidth:!0,onChange:e=>t({name:"handleChange",data:e}),id:"outlined-basic",placeholder:"Search",variant:"outlined",autoComplete:"false",sx:{"& .MuiOutlinedInput-root":{borderRadius:"10px"}},InputProps:{startAdornment:(0,M.jsx)(L.A,{position:"start",children:(0,M.jsx)(V.A,{})})}}),(0,M.jsx)(s.A,{sx:{height:"420px",overflowY:"scroll",p:1},children:i.map(((e,i)=>{var s;return(0,M.jsxs)(p.Ay,{container:!0,spacing:3,onClick:()=>t({name:"select",data:e}),sx:{p:0},children:[(0,M.jsx)(p.Ay,{item:!0,xs:2,sx:{display:"flex",justifyContent:"center",alignItems:"center"},children:(0,M.jsx)(r.A,{src:e.displayPicSrc,alt:"profile",style:{width:"2rem",height:"2rem",borderRadius:"50%"}})}),(0,M.jsx)(p.Ay,{item:!0,xs:8,children:(0,M.jsx)("h5",{children:(0,x.r0)(e.firstName)+" "+(0,x.r0)(null===e||void 0===e?void 0:e.lastName)})}),(0,M.jsx)(p.Ay,{item:!0,xs:2,sx:{display:"flex",justifyContent:"center",alignItems:"center"},children:null!==(s=n.current)&&void 0!==s&&s.find((t=>t._id===e._id))?(0,M.jsx)("span",{style:{color:"rgb(255, 117, 26)"},children:"Friend"}):(0,M.jsx)(U.A,{sx:{fontSize:"1.2rem",color:"teal"}})})]})}))})]})},K=e=>{var t,i;let{open:n,setOpen:l}=e;const[r,d]=(0,u.useState)(null),[o,a]=(0,u.useState)(!1),[p,h]=(0,u.useState)([]),m=(0,v.G)((e=>e.sharedInfo)),y=(0,v.G)((e=>e.chats)),j=[...y.data.advisors,...y.data.community],b=(0,u.useRef)(null!==(t=m.data)&&void 0!==t&&t._id?(0,x.M7)(j,null===(i=m.data)||void 0===i?void 0:i._id):[]),w=(0,v.j)();return(0,M.jsx)("div",{children:(0,M.jsx)(c.A,{open:n,sx:{right:"0",left:{md:"45%",xs:"0",lg:"68%"},top:{md:"10px",xs:"0",lg:"25px"}},PaperProps:{style:{borderRadius:"1rem",padding:"1rem",width:"410px",height:"550px"}},TransitionComponent:q,keepMounted:!0,onClose:()=>l(!1),"aria-describedby":"alert-dialog-slide-description",children:o?(0,M.jsx)("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",height:"300px"},children:(0,M.jsx)(g.A,{})}):(0,M.jsxs)(M.Fragment,{children:[(0,M.jsx)(s.A,{sx:{display:"flex",alignItems:"center",justifyContent:"center"},children:(0,M.jsx)(f.A,{onClick:()=>l(!1),sx:{width:"2rem",height:"2rem"}})}),(0,M.jsx)(Y,{searchTerm:r,eventHandler:async e=>{switch(e.name){case"handleChange":""!==e.data.target.value&&(d(e.data.target.value),(async e=>{const t=await(0,A.iT)(e);var i;t&&void 0!==t.data&&h(null===t||void 0===t||null===(i=t.data)||void 0===i?void 0:i.filter((e=>{var t;return e._id!==(null===(t=m.data)||void 0===t?void 0:t._id)})))})(e.data.target.value.trim()));break;case"select":a(!0),a(!1),l(!1);const t=await(async e=>{try{const t=await(0,A.V4)(e);return t&&t.data,t.data}catch(t){}})(e.data._id);w((0,_.Nl)(t))}},options:p,friends:b})]})})})};var Z=i(47500),J=i(76040),Q=i(74802),X=i(86598);const $=u.forwardRef((function(e,t){return(0,M.jsx)(n.A,{direction:"up",ref:t,...e})})),ee=e=>{let{open:t,setOpen:i,id:n,type:l}=e;const h=(0,v.G)((e=>e.sharedInfo)),j=(0,u.useRef)([]),[k,C]=(0,u.useState)(!1),I=(0,v.G)((e=>e.messages)),[R,N]=(0,u.useState)([]),[T,z]=(0,u.useState)(null),[B,P]=(0,u.useState)(!1),[O,E]=(0,u.useState)(""),[D,H]=(0,u.useState)(""),G=(0,v.G)((e=>{let t=e.chats;return"advisors"===l?t.data.advisors.find((e=>e._id===n)):t.data.community.find((e=>e._id===n))})),W=(0,v.j)(),L=null===G||void 0===G?void 0:G.participants.find((e=>{var t;return e._id!==(null===h||void 0===h||null===(t=h.data)||void 0===t?void 0:t._id)})),V=async()=>{const e=await(0,A.de)(n);if(e.success&&(W((0,_.wi)(e.data)),h.data&&h.data._id&&Object.values(h.data).every((e=>void 0!==typeof e)))){let t={action:"seen",sender:{...h.data,userType:"student"},recievers:null===G||void 0===G?void 0:G.participants.filter((e=>{var t;return e._id!==(null===(t=h.data)||void 0===t?void 0:t._id)})),data:e.data};w.A.emit("trigger",t),console.log(t)}},U=async e=>{let t;switch(e.name){case"send":const s=new FormData;s.append("content",e.data),s.append("chatId",n);try{if(e.data.trim()){const t=await(0,A._N)(s);H("Ava is typing"),t.data.success?(W((0,_.wi)(t.data.data.chat)),W((0,b.tj)(t.data.data.message)),N([])):console.error("Failed to send message or upload files.");const i=await(0,A.G5)({content:e.data,chatId:n});H(""),i.data.success?(W((0,_.wi)(i.data.data.chat)),W((0,b.tj)(i.data.data.message))):console.error("Failed to send message or upload files.")}}catch(i){console.error("Error during file upload or message sending:",i)}break;case"startTyping":t={action:"typing",sender:{...h.data,userType:"student"},recievers:null===G||void 0===G?void 0:G.participants.filter((e=>{var t;return e._id!=(null===(t=h.data)||void 0===t?void 0:t._id)})),data:"start"}}};(0,u.useEffect)((()=>{(async()=>{try{C(!0);const e=await(0,A.qH)(n);if(e){let t=e.data.map((e=>({...e,type:"normal"})));t.reverse(),W((0,b.bq)({requestStatus:"initiated",responseStatus:"recieved",haveAnIssue:!1,issue:"",data:t})),0!=(null===G||void 0===G?void 0:G.unSeenMessages.filter((e=>{var t;return e.message.sender._id!==(null===(t=h.data)||void 0===t?void 0:t._id)})).filter((e=>!e.seen.find((e=>{var t;return e===(null===(t=h.data)||void 0===t?void 0:t._id)})))).length)&&await V()}C(!1)}catch(e){C(!1)}})()}),[]),j.current=G&&h.data?((e,t,i)=>{let n=t.participants.filter((e=>e._id!=i._id)),s=[],l=[];e.reverse(),e.forEach((e=>{var r;if((null===(r=e.sender)||void 0===r?void 0:r._id)==i._id)if(0!=n.length){if(0==t.unSeenMessages.length?0!=n.length&&(l=[...n]):l=t.unSeenMessages.find((t=>t.message._id==e._id))?n.filter((i=>{var n;return null===(n=t.unSeenMessages.find((t=>t.message._id==e._id)))||void 0===n?void 0:n.seen.find((e=>e==i._id))})):[...n],0!=l.length){let i=l.reduce(((e,t)=>e+t.firstName+" , "),"Seen by ");s.push({_id:e._id+"_seen",type:"seen",content:i.substring(0,i.length-3),chat:t._id})}s.push(e),n=n.filter((e=>!l.find((t=>t._id==e._id))))}else s.push(e);else s.push(e)})),s.reverse();let r=t.participants.filter((e=>"typing"==e.activity));if(0!=r.length){let e=r.reduce(((e,t)=>t.firstName+" , "),"");s.push({_id:t._id+"_typing",type:"typing",content:e.substring(0,e.length-3)+(1==r.length?" is typing":" are typing"),chat:t._id,sender:{displayPicSrc:"",firstName:"",lastName:"",email:"",_id:t._id+"_typing",userType:""}})}return s})([...I.data],G,h.data):[];const q=e=>(0,M.jsx)("div",{style:{background:"#F8F8FC",padding:"0.5rem",borderRadius:"0.8rem",position:"relative"},children:(0,M.jsxs)(o.A,{direction:"row",spacing:2,alignItems:"center",justifyContent:"space-between",children:[(0,M.jsxs)(s.A,{sx:{display:"flex",gap:"1rem",alignItems:"center"},children:[(0,M.jsx)(r.A,{src:"Virtual_Assistant"===(null===L||void 0===L?void 0:L.role)?y.A.ai:null===L||void 0===L?void 0:L.displayPicSrc,alt:"profile",sx:{width:"3rem",height:"3rem",borderRadius:"50%"}}),(0,M.jsx)(d.A,{fontWeight:"500",sx:{position:"absolute",right:"10px",top:"-1rem",background:"#fff",p:1,borderRadius:"10px",color:"counsellor"===(null===L||void 0===L?void 0:L.role)?"#3B3F76":"processCoordinator"===(null===L||void 0===L?void 0:L.role)?"#569228":"#FEB853",fontSize:"14px"},children:null!==L&&void 0!==L&&L.role?(0,x.AZ)(null===L||void 0===L?void 0:L.role):null===L||void 0===L?void 0:L.role}),(0,M.jsx)(s.A,{children:null!==L&&void 0!==L&&L.firstName||null!==L&&void 0!==L&&L.lastName?(0,M.jsxs)(d.A,{fontWeight:"500",children:[(0,x.r0)(null===L||void 0===L?void 0:L.firstName),"\xa0",(0,x.r0)(null===L||void 0===L?void 0:L.lastName)]}):(0,M.jsx)(d.A,{children:"User"})})]}),(0,M.jsx)(s.A,{sx:{float:"right"},children:(0,M.jsx)(a.A,{sx:{textTransform:"none",color:"#3b3f76",float:"right"},onClick:()=>e.eventHandler({name:"block",data:{action:"block",id:null===L||void 0===L?void 0:L._id}}),children:L&&"Virtual_Assistant"!==(null===L||void 0===L?void 0:L.role)&&"Block"})})]})}),Y=()=>{const e=(0,u.useRef)(null),t=(0,u.useRef)(null),[i,n]=(0,u.useState)(!0);return(0,u.useEffect)((()=>{var t;i&&(null===(t=e.current)||void 0===t||t.scrollIntoView({behavior:"auto"}))}),[j.current]),(0,u.useEffect)((()=>{var t;null===(t=e.current)||void 0===t||t.scrollIntoView({behavior:"auto"})}),[]),(0,M.jsx)(s.A,{ref:t,onScroll:()=>{if(t.current){const{scrollTop:e,scrollHeight:i,clientHeight:s}=t.current;n(i-e-s<=5)}},sx:{overflowY:"scroll",mt:3,height:"390px","&::-webkit-scrollbar":{width:"12px"},"&::-webkit-scrollbar-thumb":{backgroundColor:"transparent",borderRadius:"8px"}},children:k?(0,M.jsx)(s.A,{sx:{display:"flex",justifyContent:"center",alignItems:"center",height:"300px"},children:(0,M.jsx)(g.A,{})}):(0,M.jsx)("div",{className:"chat-container",children:j.current.length>0?(0,M.jsxs)(M.Fragment,{children:[j.current.map((e=>{var t,i,n,s,l,d,o,a,c;return(0,M.jsx)(M.Fragment,{children:"seen"!==e.type&&"typing"!==e.type?(0,M.jsxs)("div",{className:"message ".concat((null===e||void 0===e||null===(t=e.sender)||void 0===t?void 0:t._id)===(null===(i=h.data)||void 0===i?void 0:i._id)?"sent":"received"),children:[(0,M.jsx)(F,{content:e.content}),null!==e&&void 0!==e&&null!==(n=e.document)&&void 0!==n&&null!==(s=n.data)&&void 0!==s&&s.preview_url?(0,M.jsx)("iframe",{src:null===e||void 0===e||null===(l=e.document)||void 0===l||null===(d=l.data)||void 0===d?void 0:d.preview_url,title:"preview",style:{border:"none",width:"150px",height:"150px",objectFit:"contain"}}):"",(0,M.jsx)(r.A,{src:null===(o=e.sender)||void 0===o?void 0:o.displayPicSrc,alt:"",sx:(null===e||void 0===e||null===(a=e.sender)||void 0===a?void 0:a._id)===(null===(c=h.data)||void 0===c?void 0:c._id)?{width:"1.5rem",height:"1.5rem",borderRadius:"50%",position:"absolute",top:"-12px",right:0}:{width:"1.5rem",height:"1.5rem",borderRadius:"50%",position:"absolute",top:"-12px",left:0}})]},e._id):(0,M.jsx)(M.Fragment,{children:(0,M.jsx)("div",{className:"seenMsg",children:e.content})})})})),D&&(0,M.jsx)(d.A,{sx:{textAlign:"right",fontSize:"13px",color:"#3b3f76",marginTop:"8px"},children:D}),(0,M.jsx)("div",{ref:e})]}):L?(0,M.jsx)(d.A,{textAlign:"center",children:"Start chat"}):(0,M.jsx)(d.A,{textAlign:"center",children:"No chat"})})})},K=e=>{const[t,i]=(0,u.useState)(""),[n,s]=(0,u.useState)(!1),l=((0,u.useRef)(null),async()=>{try{""!==t.trim()||R&&R.length>0?(s(!0),await e.eventHandler({name:"send",data:t})):console.log("No content or files to send.")}catch(i){console.error("Error while sending:",i)}finally{s(!1)}});return(0,M.jsx)(M.Fragment,{children:L&&(0,M.jsxs)("div",{style:{position:"relative"},children:[(null===R||void 0===R?void 0:R.length)>0&&(0,M.jsx)("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",position:"absolute",top:"-44px",right:"35%"},children:(0,M.jsxs)("div",{style:{width:"fitContent"},children:[(0,M.jsx)(d.A,{fontSize:"0.9rem",children:"Selected files:"}),(0,M.jsx)("ul",{style:{listStyle:"none",padding:0,margin:0},children:R.map(((e,t)=>(0,M.jsxs)("li",{style:{fontSize:"12px",display:"flex"},children:[e.name,(0,M.jsx)(S.A,{onClick:()=>(e=>{const t=[...R];t.splice(e,1),N(t)})(t),sx:{fontSize:"1rem",cursor:"pointer"}})]},t)))})]})}),B?(0,M.jsx)("div",{className:"replyDiv",children:(0,M.jsxs)("h5",{children:["reply to:- ",O]})}):"",(0,M.jsxs)(p.Ay,{container:!0,sx:{background:"#F8F8FC",padding:"0.5rem",borderRadius:"0.8rem"},children:[(0,M.jsx)(p.Ay,{item:!0,xs:9.5,children:(0,M.jsx)(m.A,{variant:"outlined",size:"small",onFocus:()=>e.eventHandler({name:"startTyping"}),onBlur:()=>e.eventHandler({name:"stopTyping"}),multiline:!0,rows:2,fullWidth:!0,placeholder:"Type your message...",value:t,sx:{"& .MuiOutlinedInput-notchedOutline":{border:0,"&:Focus":{border:0}},"& .Mui-focused .MuiOutlinedInput-notchedOutline":{border:"none !important"}},onChange:e=>i(e.target.value),onKeyDown:e=>{"Enter"!==e.key||e.shiftKey||""===t.trim()||(e.preventDefault(),l())}})}),(0,M.jsx)(p.Ay,{item:!0,xs:1.5,sx:{display:"flex",justifyContent:"center",alignItems:"center",background:"#fff",borderRadius:"6px"},children:n?(0,M.jsx)("img",{src:y.A.standardLoader,alt:"loader",style:{width:"1rem"}}):(0,M.jsx)("img",{src:y.A.sendIcon,alt:"sendIcon",style:{width:"2rem",height:"2rem"},onClick:l})})]})]})})};return(0,M.jsx)("div",{children:(0,M.jsxs)(c.A,{open:t,sx:{right:"0",left:{md:"45%",xs:"0",lg:"68%"},top:{md:"10px",xs:"0",lg:"25px"}},PaperProps:{style:{borderRadius:"1rem",padding:"1rem",width:"410px",height:"582px"}},TransitionComponent:$,keepMounted:!0,onClose:()=>i(!1),"aria-describedby":"alert-dialog-slide-description",children:[(0,M.jsx)(s.A,{sx:{display:"flex",alignItems:"center",justifyContent:"center"},children:(0,M.jsx)(f.A,{sx:{position:"absolute",top:0,color:"#0F0F0F",fontSize:"2rem",cursor:"pointer",display:"flex",justifyContent:"center",alignItems:"center"},onClick:()=>i(!1)})}),(0,M.jsxs)(s.A,{sx:{mt:3},children:[(0,M.jsx)(q,{eventHandler:U}),(0,M.jsx)(Y,{}),(0,M.jsx)(K,{eventHandler:U})]})]})})},te=e=>{var t,i;const[n,s]=(0,u.useState)(!1),[l,r]=(0,u.useState)(!1),d=(0,v.j)(),[o,a]=(0,u.useState)(null),c=(0,v.G)((e=>e.userAuthStatus)),p=e=>{a(e)},h=()=>{a(null)},x=(0,v.G)((e=>e.chats)),g=(e=>{for(const i of e){var t;if(null===i||void 0===i||null===(t=i.participants)||void 0===t?void 0:t.find((e=>"Virtual_Assistant"===e.role)))return i}return null})(null===x||void 0===x||null===(t=x.data)||void 0===t?void 0:t.advisors);return(0,M.jsxs)("div",{style:{position:"fixed",bottom:16,right:16,zIndex:1},children:[(0,M.jsxs)(Z.A,{ariaLabel:"Custom SpeedDial",icon:n?(0,M.jsx)(Q.A,{style:{color:"white",fontSize:"28px"}}):(0,M.jsx)(X.A,{style:{color:"white",fontSize:"28px"}}),onClick:()=>{s((e=>!e))},open:n,direction:"up",FabProps:{style:{backgroundColor:"#3b3f76",color:"white"}},children:[(0,M.jsx)(J.A,{icon:(0,M.jsx)("img",{style:{width:"3rem",height:"3rem",cursor:"pointer"},src:y.A.chaticon,alt:"chat icon"}),tooltipOpen:"chat"===o,tooltipTitle:(0,M.jsx)("div",{style:{width:"120px",textAlign:"center"},children:"Chat with us"}),onClick:()=>e.setOpen(!0),onMouseEnter:()=>p("chat"),onMouseLeave:h}),(0,M.jsx)(J.A,{icon:(0,M.jsx)("img",{style:{width:"1.7rem",height:"1.7rem",cursor:"pointer",filter:"invert(1)"},src:y.A.ai,alt:"AI chat icon"}),FabProps:{style:{backgroundColor:"#3b3f76",color:"white",width:"45px",height:"45px"}},tooltipOpen:"ai"===o,tooltipTitle:(0,M.jsx)("div",{style:{width:"120px",textAlign:"center"},children:"Chat with AI"}),onClick:()=>{var e;null!==(e=c.data)&&void 0!==e&&e.isAuthorized?r(!0):d((0,W.DE)({show:!0,data:{container:{name:"login",dimensions:{width:"800px",height:"70%",show:"none"}},type:"custom"}}))},onMouseEnter:()=>p("ai"),onMouseLeave:h})]}),null!==(i=c.data)&&void 0!==i&&i.isAuthorized&&l?(0,M.jsx)(ee,{open:l,setOpen:r,id:null===g||void 0===g?void 0:g._id,type:"advisors"}):null]})},ie=u.forwardRef((function(e,t){return(0,M.jsx)(n.A,{direction:"up",ref:t,...e})})),ne=()=>{const e=(0,v.j)();return(0,M.jsxs)("div",{style:{background:"#EDF2F6",padding:"1.5rem",borderRadius:"10px",position:"relative"},children:[(0,M.jsxs)(s.A,{sx:{display:"flex",flexDirection:"column",alignItems:"start",justifyContent:"start",mb:2},children:[(0,M.jsxs)(l.A,{max:4,children:[(0,M.jsx)(r.A,{alt:"Remy Sharp",src:"/static/images/avatar/1.jpg"}),(0,M.jsx)(r.A,{alt:"Travis Howard",src:"/static/images/avatar/2.jpg"}),(0,M.jsx)(r.A,{alt:"Cindy Baker",src:"/static/images/avatar/3.jpg"}),(0,M.jsx)(r.A,{alt:"Agnes Walker",src:"/static/images/avatar/4.jpg"}),(0,M.jsx)(r.A,{alt:"Trevor Henderson",src:"/static/images/avatar/5.jpg"})]}),(0,M.jsx)(d.A,{color:"#3B3F76",fontWeight:"600",gutterBottom:!0,children:"Say goodbye to all your doubts !"}),(0,M.jsxs)(d.A,{color:"rgba(48, 51, 99, 0.5)",gutterBottom:!0,children:["As you say hello to our profound advisors !"," "]})]}),(0,M.jsxs)(s.A,{sx:{background:"#fff",p:2,borderRadius:"10px",position:"absolute",left:"20px",right:"20px",boxShadow:"2",display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center"},children:[(0,M.jsxs)(d.A,{gutterBottom:!0,children:["Login to start chat with"," ",(0,M.jsx)("span",{style:{color:"rgba(48, 51, 99, 0.5)"},children:"Students "}),"and ",(0,M.jsx)("span",{style:{color:"rgba(48, 51, 99, 0.5)"},children:"Advisors"}),"."]}),(0,M.jsx)(G.S,{width:"100px",handleSubmit:()=>{e((0,W.DE)({show:!0,data:{container:{name:"login",dimensions:{width:"800px",height:"70%",show:"none"}},type:"custom"}}))},children:"Login"})]})]})},se=()=>{var e;const t=(0,v.G)((e=>e.userAuthStatus)),[i,n]=(0,u.useState)(!1),[l,r]=(0,u.useState)(!1),d=()=>{const[e,t]=(0,u.useState)("advisors");return(0,M.jsxs)(o.A,{spacing:1,sx:{height:"480px",p:2,justifyContent:"center",alignItems:"center"},children:[(0,M.jsxs)(s.A,{sx:{display:"flex",justifyContent:"center",alignItems:"center",width:"80%",gap:"1rem"},children:[(0,M.jsx)(a.A,{onClick:()=>t("advisors"),sx:{borderBottom:"advisors"===e?"2px solid #3B3F76":0,color:"advisors"===e?"#3B3F76":"#3b3f7699",borderRadius:0,textTransform:"none",fontSize:"0.9rem"},children:"Advisors"}),(0,M.jsx)(a.A,{onClick:()=>t("community"),sx:{borderBottom:"community"===e?"2px solid #3B3F76":0,color:"community"===e?"#3B3F76":"#3b3f7699",textTransform:"none",borderRadius:0,fontSize:"0.9rem"},children:"Community"})]}),"advisors"===e?(0,M.jsx)(O,{}):"community"===e?(0,M.jsx)(D,{}):"",(0,M.jsx)("div",{style:{position:"absolute",bottom:"12px",right:"12px"},children:(0,M.jsx)("div",{onClick:()=>r(!0),style:{background:"#3B3F76",color:"#fff",height:"1rem",width:"1rem",borderRadius:"50%",padding:"0.2rem",cursor:"pointer"},children:(0,M.jsx)(H.A,{sx:{fontSize:"1rem"}})})})]})};return(0,M.jsx)("div",{children:(0,M.jsxs)("div",{children:[(0,M.jsx)(te,{setOpen:n}),(0,M.jsx)(c.A,{open:i,sx:{right:"0",left:{md:"45%",xs:"0",lg:"68%"},top:{md:"1%",xs:"0",lg:"5%"}},PaperProps:{style:{borderRadius:"1rem",padding:"1rem",width:"410px",height:"550px"}},TransitionComponent:ie,keepMounted:!0,onClose:()=>n(!1),"aria-describedby":"alert-dialog-slide-description",children:(0,M.jsxs)(s.A,{children:[(0,M.jsx)(s.A,{sx:{display:"flex",justifyContent:"center"},children:(0,M.jsx)(f.A,{onClick:()=>n(!1),sx:{position:"absolute",top:0,color:"#0F0F0F",fontSize:"2rem",cursor:"pointer",display:"flex",justifyContent:"center",alignItems:"center"}})}),null!==(e=t.data)&&void 0!==e&&e.isAuthorized?(0,M.jsx)(d,{}):(0,M.jsx)("div",{style:{display:"flex",flexDirection:"column",justifyContent:"center",height:"50vh"},children:(0,M.jsx)(ne,{})})]})}),l?(0,M.jsx)(K,{open:l,setOpen:r}):""]})})}}}]);
//# sourceMappingURL=518.706d1bb7.chunk.js.map