"use strict";(self.webpackChunkstudent_typescript=self.webpackChunkstudent_typescript||[]).push([[518],{83518:(e,i,t)=>{t.r(i),t.d(i,{GuestUser:()=>se,default:()=>re});var n=t(24836),s=t(96446),r=t(25754),l=t(60587),o=t(85865),d=t(88911),a=t(11906),c=t(90035),u=t(65043),v=t(29378),p=t(68903),x=t(12110),h=t(74354),g=t(81637),m=t(67784),f=t(54536),y=t(57515),j=t(99380),A=t(55797),b=t(54712),_=t(18723),w=t(66748),S=t(33438),C=t(78619),k=t(87977),M=t(70579);const F=e=>{let{content:i}=e;const t=k.A.sanitize(i);return(0,M.jsx)(C.o,{components:{a:e=>{let{href:i,children:t,...n}=e;return(0,M.jsx)("a",{href:i,target:"_blank",rel:"noopener noreferrer",...n,children:t})}},children:t})};var I=t(86651),R=t(61610);const N=u.forwardRef((function(e,i){return(0,M.jsx)(n.A,{direction:"up",ref:i,...e})})),z=e=>{let{open:i,setOpen:t,id:n,type:r}=e;const x=(0,v.G)((e=>e.sharedInfo)),C=(0,v.G)((e=>e.BlockedList)),k=(0,u.useRef)([]),[z,T]=(0,u.useState)(!1),B=(0,v.G)((e=>e.messages)),[P,H]=(0,u.useState)([]),[O,D]=(0,u.useState)(null),[E,G]=(0,u.useState)(!1),[W,L]=(0,u.useState)(""),[V,U]=(0,u.useState)(!1),[q,Y]=(0,u.useState)(""),K=(0,v.G)((e=>{let i=e.chats;return"advisors"===r?i.data.advisors.find((e=>e._id===n)):i.data.community.find((e=>e._id===n))})),Z=(0,v.j)(),J=null===K||void 0===K?void 0:K.participants.find((e=>{var i;return e._id!==(null===x||void 0===x||null===(i=x.data)||void 0===i?void 0:i._id)})),Q=async()=>{const e=await(0,A.de)(n);if(e.success&&(Z((0,_.wi)(e.data)),x.data&&x.data._id&&Object.values(x.data).every((e=>void 0!==typeof e)))){let i={action:"seen",sender:{...x.data,userType:"student"},recievers:null===K||void 0===K?void 0:K.participants.filter((e=>{var i;return e._id!==(null===(i=x.data)||void 0===i?void 0:i._id)})),data:e.data};w.A.emit("trigger",i)}},X=e=>{if("send"===e.action)Z((0,b.tj)({...e.data.message,type:"normal"})),Q()},$=async e=>{let i;switch(e.name){case"send":const r=new FormData;if(!e.data.trim()&&0===P.length)return void console.error("No message content or valid files to upload.");r.append("content",e.data),r.append("chatId",n);let l=0;if(P.length>0){const i=["image/jpeg","image/jpg","image/png","application/pdf","application/msword","application/vnd.openxmlformats-officedocument.wordprocessingml.document"],t=P.filter((e=>{const t=i.includes(null===e||void 0===e?void 0:e.type),n=(null===e||void 0===e?void 0:e.size)<=16777216;return t&&n}));if(0===t.length&&!e.data)return;if(t.forEach((e=>{r.append("uploaded_file",e),l+=e.size})),0===t.length&&!e.data.trim())return void console.error("No valid files selected and no message content.")}try{if(e.data.trim()||l>0){const e=await(0,A._N)(r);if(e.data.success){Z((0,_.wi)(e.data.data.chat)),Z((0,b.tj)(e.data.data.message));const i={action:"send",sender:{...x.data,userType:"student"},recievers:null===K||void 0===K?void 0:K.participants.filter((e=>{var i;return e._id!==(null===(i=x.data)||void 0===i?void 0:i._id)})),data:e.data.data};w.A.emit("trigger",i),H([])}else console.error("Failed to send message or upload files.")}}catch(t){console.error("Error during file upload or message sending:",t)}break;case"startTyping":i={action:"typing",sender:{...x.data,userType:"student"},recievers:null===K||void 0===K?void 0:K.participants.filter((e=>{var i;return e._id!=(null===(i=x.data)||void 0===i?void 0:i._id)})),data:"start"},w.A.emit("trigger",i);break;case"stopTyping":i={action:"typing",sender:{...x.data,userType:"student"},recievers:null===K||void 0===K?void 0:K.participants.filter((e=>{var i;return e._id!=(null===(i=x.data)||void 0===i?void 0:i._id)})),data:"stop"},w.A.emit("trigger",i);break;case"block":try{const i=await(0,A.wy)(q,e.data.id);Z("block"===q?(0,R.EP)(i.data.data.blocked):(0,R.Rf)(i.data.data.blocked._id))}catch(s){console.log(s)}}};(0,u.useEffect)((()=>(w.A.removeListener("trigger",X),w.A.on("trigger",X),(async()=>{try{T(!0);const e=await(0,A.qH)(n);if(e){let i=e.data.map((e=>({...e,type:"normal"})));i.reverse(),Z((0,b.bq)({requestStatus:"initiated",responseStatus:"recieved",haveAnIssue:!1,issue:"",data:i})),0!=(null===K||void 0===K?void 0:K.unSeenMessages.filter((e=>{var i;return e.message.sender._id!==(null===(i=x.data)||void 0===i?void 0:i._id)})).filter((e=>!e.seen.find((e=>{var i;return e===(null===(i=x.data)||void 0===i?void 0:i._id)})))).length)&&await Q()}T(!1)}catch(e){}T(!1)})(),()=>{w.A.removeListener("trigger",X)})),[]),k.current=K&&x.data?((e,i,t)=>{let n=i.participants.filter((e=>e._id!=t._id)),s=[],r=[];e.reverse(),e.forEach((e=>{var l;if((null===(l=e.sender)||void 0===l?void 0:l._id)==t._id)if(0!=n.length){if(0==i.unSeenMessages.length?0!=n.length&&(r=[...n]):r=i.unSeenMessages.find((i=>i.message._id==e._id))?n.filter((t=>{var n;return null===(n=i.unSeenMessages.find((i=>i.message._id==e._id)))||void 0===n?void 0:n.seen.find((e=>e==t._id))})):[...n],0!=r.length){let t=r.reduce(((e,i)=>e+i.firstName+" , "),"Seen by ");s.push({_id:e._id+"_seen",type:"seen",content:t.substring(0,t.length-3),chat:i._id})}s.push(e),n=n.filter((e=>!r.find((i=>i._id==e._id))))}else s.push(e);else s.push(e)})),s.reverse();let l=i.participants.filter((e=>"typing"==e.activity));if(0!=l.length){let e=l.reduce(((e,i)=>i.firstName+" , "),"");s.push({_id:i._id+"_typing",type:"typing",content:e.substring(0,e.length-3)+(1==l.length?" is typing":" are typing"),chat:i._id,sender:{displayPicSrc:"",firstName:"",lastName:"",email:"",_id:i._id+"_typing",userType:""}})}return s})([...B.data],K,x.data):[];const ee=e=>(0,M.jsx)("div",{style:{background:"#F8F8FC",padding:"0.5rem",borderRadius:"0.8rem",position:"relative"},children:(0,M.jsxs)(d.A,{direction:"row",spacing:2,alignItems:"center",justifyContent:"space-between",children:[(0,M.jsxs)(s.A,{sx:{display:"flex",gap:"1rem",alignItems:"center"},children:[(0,M.jsx)(l.A,{src:"Virtual_Assistant"===(null===J||void 0===J?void 0:J.role)?y.A.ai:null===J||void 0===J?void 0:J.displayPicSrc,alt:"profile",sx:{width:"3rem",height:"3rem",borderRadius:"50%"}}),(0,M.jsx)(o.A,{fontWeight:"500",sx:{position:"absolute",right:"10px",top:"-1rem",background:"#fff",p:1,borderRadius:"10px",color:"counsellor"===(null===J||void 0===J?void 0:J.role)?"#3B3F76":"processCoordinator"===(null===J||void 0===J?void 0:J.role)?"#569228":"#FEB853",fontSize:"14px"},children:null!==J&&void 0!==J&&J.role?(0,h.AZ)(null===J||void 0===J?void 0:J.role):null===J||void 0===J?void 0:J.role}),(0,M.jsx)(s.A,{children:null!==J&&void 0!==J&&J.firstName||null!==J&&void 0!==J&&J.lastName?(0,M.jsxs)(o.A,{fontWeight:"500",children:[(0,h.r0)(null===J||void 0===J?void 0:J.firstName),"\xa0",(0,h.r0)(null===J||void 0===J?void 0:J.lastName)]}):(0,M.jsx)(o.A,{children:"User"})})]}),"member"!==(null===J||void 0===J?void 0:J.userType)&&(0,M.jsx)(s.A,{sx:{float:"right"},children:(0,M.jsx)(a.A,{sx:{textTransform:"none",color:"#3b3f76",float:"right"},onClick:()=>{const i=C.data.some((e=>(null===e||void 0===e?void 0:e._id)===(null===J||void 0===J?void 0:J._id)));Y(i?"unblock":"block"),e.setBlockOpen(!0)},children:C.data.some((e=>(null===e||void 0===e?void 0:e._id)===(null===J||void 0===J?void 0:J._id)))?"Unblock":"Block"})})]})}),ie=()=>{const e=(0,u.useRef)(null),i=(0,u.useRef)(null),[t,n]=(0,u.useState)(!0);return(0,u.useEffect)((()=>{var i;t&&(null===(i=e.current)||void 0===i||i.scrollIntoView({behavior:"auto"}))}),[k.current]),(0,u.useEffect)((()=>{var i;null===(i=e.current)||void 0===i||i.scrollIntoView({behavior:"auto"})}),[]),(0,M.jsxs)(s.A,{ref:i,onScroll:()=>{if(i.current){const{scrollTop:e,scrollHeight:t,clientHeight:s}=i.current;n(t-e-s<=5)}},sx:{overflowY:"scroll",mt:3,height:"390px","&::-webkit-scrollbar":{width:"12px"},"&::-webkit-scrollbar-thumb":{backgroundColor:"transparent",borderRadius:"8px"}},children:[z?(0,M.jsx)(s.A,{sx:{display:"flex",justifyContent:"center",alignItems:"center",height:"300px"},children:(0,M.jsx)(g.A,{})}):(0,M.jsx)("div",{className:"chat-container",children:k.current.length>0?(0,M.jsxs)(M.Fragment,{children:[k.current.map((e=>{var i,t,n,s,r,o,d,a,c;return(0,M.jsx)(M.Fragment,{children:"seen"!==e.type&&"typing"!==e.type?(0,M.jsxs)("div",{className:"message ".concat((null===e||void 0===e||null===(i=e.sender)||void 0===i?void 0:i._id)===(null===(t=x.data)||void 0===t?void 0:t._id)?"sent":"received"),children:[(0,M.jsx)(F,{content:e.content}),null!==e&&void 0!==e&&null!==(n=e.document)&&void 0!==n&&null!==(s=n.data)&&void 0!==s&&s.preview_url?(0,M.jsx)("iframe",{src:null===e||void 0===e||null===(r=e.document)||void 0===r||null===(o=r.data)||void 0===o?void 0:o.preview_url,title:"preview",style:{border:"none",width:"150px",height:"150px",objectFit:"contain"}}):"",(0,M.jsx)(l.A,{src:null===(d=e.sender)||void 0===d?void 0:d.displayPicSrc,alt:"",sx:(null===e||void 0===e||null===(a=e.sender)||void 0===a?void 0:a._id)===(null===(c=x.data)||void 0===c?void 0:c._id)?{width:"1.5rem",height:"1.5rem",borderRadius:"50%",position:"absolute",top:"-12px",right:0}:{width:"1.5rem",height:"1.5rem",borderRadius:"50%",position:"absolute",top:"-12px",left:0}})]},e._id):(0,M.jsx)("div",{className:"seenMsg",children:e.content})})})),(0,M.jsx)("div",{ref:e}),"          "]}):J?(0,M.jsx)(o.A,{textAlign:"center",children:"Start chat"}):(0,M.jsx)(o.A,{textAlign:"center",children:"No chat"})}),"  ",C.data.some((e=>(null===e||void 0===e?void 0:e._id)===(null===J||void 0===J?void 0:J._id)))&&(0,M.jsx)(o.A,{textAlign:"center",fontSize:"0.9rem",children:"You blocked this member."})]})},te=e=>{const[i,n]=(0,u.useState)(""),[s,r]=(0,u.useState)(!1),l=(0,u.useRef)(null),d=async()=>{try{""!==i.trim()||P&&P.length>0?(r(!0),t(!0),await e.eventHandler({name:"send",data:i})):console.log("No content or files to send.")}catch(n){console.error("Error while sending:",n)}finally{r(!1)}};return(0,M.jsx)(M.Fragment,{children:J&&(0,M.jsxs)("div",{style:{position:"relative"},children:[(null===P||void 0===P?void 0:P.length)>0&&(0,M.jsx)("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",position:"absolute",top:"-44px",right:"35%"},children:(0,M.jsxs)("div",{style:{width:"fitContent"},children:[(0,M.jsx)(o.A,{fontSize:"0.9rem",children:"Selected files:"}),(0,M.jsx)("ul",{style:{listStyle:"none",padding:0,margin:0},children:P.map(((e,i)=>(0,M.jsxs)("li",{style:{fontSize:"12px",display:"flex"},children:[e.name,(0,M.jsx)(S.A,{onClick:()=>(e=>{const i=[...P];i.splice(e,1),H(i)})(i),sx:{fontSize:"1rem",cursor:"pointer"}})]},i)))})]})}),E?(0,M.jsx)("div",{className:"replyDiv",children:(0,M.jsxs)("h5",{children:["reply to:- ",W]})}):"",C.data.some((e=>(null===e||void 0===e?void 0:e._id)===(null===J||void 0===J?void 0:J._id)))?"":(0,M.jsxs)(p.Ay,{container:!0,sx:{background:"#F8F8FC",padding:"0.5rem",borderRadius:"0.8rem"},children:[(0,M.jsx)(p.Ay,{item:!0,xs:1,sx:{display:"flex",justifyContent:"center",alignItems:"center"},children:(0,M.jsxs)("div",{children:[(0,M.jsx)("input",{type:"file",multiple:!0,style:{display:"none"},onChange:e=>{const i=Array.from(e.target.files);H(i)},ref:l}),(0,M.jsx)(j.A,{sx:{color:"",cursor:"pointer"},onClick:()=>{var e;return null===l||void 0===l||null===(e=l.current)||void 0===e?void 0:e.click()}})]})}),(0,M.jsx)(p.Ay,{item:!0,xs:9.5,children:(0,M.jsx)(m.A,{variant:"outlined",size:"small",onFocus:()=>e.eventHandler({name:"startTyping"}),onBlur:()=>e.eventHandler({name:"stopTyping"}),multiline:!0,rows:2,fullWidth:!0,value:i,placeholder:"Type your message...",sx:{"& .MuiOutlinedInput-notchedOutline":{border:0,"&:Focus":{border:0}},"& .Mui-focused .MuiOutlinedInput-notchedOutline":{border:"none !important"}},onChange:e=>n(e.target.value),onKeyDown:e=>{"Enter"!==e.key||e.shiftKey||""===i.trim()||(e.preventDefault(),d())}})}),(0,M.jsx)(p.Ay,{item:!0,xs:1.5,sx:{display:"flex",justifyContent:"center",alignItems:"center",background:"#fff",borderRadius:"6px"},children:s?(0,M.jsx)("img",{src:y.A.standardLoader,alt:"loader",style:{width:"1rem"}}):(0,M.jsx)("img",{src:y.A.sendIcon,alt:"sendIcon",style:{width:"2rem",height:"2rem"},onClick:d})})]})]})})};return(0,M.jsxs)("div",{children:[(0,M.jsxs)(c.A,{open:i,sx:{right:"0",left:{md:"45%",xs:"0",lg:"68%"},top:{md:"10px",xs:"0",lg:"25px"}},PaperProps:{style:{borderRadius:"1rem",padding:"1rem",width:"410px",height:"582px"}},TransitionComponent:N,keepMounted:!0,onClose:()=>t(!1),"aria-describedby":"alert-dialog-slide-description",children:[(0,M.jsx)(s.A,{sx:{display:"flex",alignItems:"center",justifyContent:"center"},children:(0,M.jsx)(f.A,{sx:{position:"absolute",top:0,color:"#0F0F0F",fontSize:"2rem",cursor:"pointer",display:"flex",justifyContent:"center",alignItems:"center"},onClick:()=>t(!1)})}),(0,M.jsxs)(s.A,{sx:{mt:3},children:[(0,M.jsx)(ee,{eventHandler:$,setBlockOpen:U}),(0,M.jsx)(ie,{}),(0,M.jsx)(te,{eventHandler:$})]})]}),(0,M.jsx)(I.A,{open:V,handleClose:()=>U(!1),additionalData:{onSubmit:()=>$({name:"block",data:{id:null===J||void 0===J?void 0:J._id}}),title:"Are you sure you want to ".concat(q," this user?"),content:""}})]})};var T=t(53253),B=t(13383);const P=e=>{var i;const[t,n]=(0,u.useState)(!1),r=(0,v.G)((e=>e.sharedInfo)),d=null===r||void 0===r?void 0:r.data,a=d?((e,i)=>{var t,n,s;let r={dp:"",name:"",unseenMessages:0,activeParticipants:[],chatType:"1-1",lastMessage:void 0,role:""},l=null===e||void 0===e||null===(t=e.participants)||void 0===t?void 0:t.find((e=>e._id===i._id)),o=null===e||void 0===e||null===(n=e.participants)||void 0===n?void 0:n.filter((e=>e._id!==i._id));var d,a,c,u,v,p;(null===e||void 0===e||null===(s=e.participants)||void 0===s?void 0:s.length)<=2?(r.name=(null===o||void 0===o?void 0:o.length)>0?(null!==o&&void 0!==o&&null!==(d=o[0])&&void 0!==d&&d.firstName?null===o||void 0===o||null===(a=o[0])||void 0===a?void 0:a.firstName:"user")+(null!==o&&void 0!==o&&null!==(c=o[0])&&void 0!==c&&c.lastName?" "+(null===o||void 0===o||null===(u=o[0])||void 0===u?void 0:u.lastName):""):"Deleted User",r.dp=(null===o||void 0===o?void 0:o.length)>0?null===o||void 0===o||null===(v=o[0])||void 0===v?void 0:v.displayPicSrc:"",r.role=(null===o||void 0===o?void 0:o.length)>0?null===o||void 0===o||null===(p=o[0])||void 0===p?void 0:p.role:""):(r.chatType="group",r.name="Group Name");return r.unseenMessages=e.unSeenMessages.filter((e=>{var t,n;return(null===(t=e.message)||void 0===t||null===(n=t.sender)||void 0===n?void 0:n._id)!==(null===i||void 0===i?void 0:i._id)})).filter((e=>!e.seen.some((e=>e===i._id)))).length,e.lastMessage&&l&&(r.lastMessage=((e,i)=>{var t,n,s;let r={sender:(null===(t=e.lastMessage)||void 0===t?void 0:t.sender)===i._id?"current":"others",message:null!==(n=e.lastMessage)&&void 0!==n&&n.content?null===(s=e.lastMessage)||void 0===s?void 0:s.content:"",status:"seen"};if("current"===r.sender)r.status=-1===e.unSeenMessages.findIndex((i=>{var t;return i.message._id===(null===(t=e.lastMessage)||void 0===t?void 0:t._id)}))?"seen":"unseen";else{let t=e.unSeenMessages.findIndex((i=>{var t;return i.message._id===(null===(t=e.lastMessage)||void 0===t?void 0:t._id)}));r.status=-1===t?"seen":-1===e.unSeenMessages[t].seen.findIndex((e=>e===i._id))?"unseen":"seen"}return r})(e,l),r.activeParticipants=((e,i)=>{let t=e.participants.filter((e=>"inchat"===e.activity&&e._id!==i._id)),n=e.participants.filter((e=>"online"===e.activity&&e._id!==i._id));return[...e.participants.filter((e=>"typing"===e.activity&&e._id!==i._id)),...t,...n]})(e,l)),r})(e.data,d):null,c=()=>{var e,i,t,n,r,l,d,c;return(0,M.jsxs)("div",{style:{display:"flex",gap:"8px",width:"100%"},children:["current"===(null===a||void 0===a||null===(e=a.lastMessage)||void 0===e?void 0:e.sender)?(0,M.jsx)(M.Fragment,{children:"seen"===(null===a||void 0===a||null===(i=a.lastMessage)||void 0===i?void 0:i.status)?(0,M.jsx)(s.A,{sx:{display:"flex"},children:(0,M.jsx)(T.A,{sx:{color:"#2196f3",fontSize:"1rem"}})}):(0,M.jsx)(s.A,{sx:{display:"flex"},children:(0,M.jsx)(T.A,{sx:{color:"gray",fontSize:"1rem"}})})}):null,(0,M.jsxs)(o.A,{sx:{fontSize:"12px",width:"200px",height:"2rem",textOverflow:"ellipsis",whiteSpace:"nowrap",overflow:"hidden",fontWeight:"current"===(null===a||void 0===a||null===(t=a.lastMessage)||void 0===t?void 0:t.sender)||"seen"===(null===a||void 0===a||null===(n=a.lastMessage)||void 0===n?void 0:n.status)?"300":"600",color:"current"===(null===a||void 0===a||null===(r=a.lastMessage)||void 0===r?void 0:r.sender)||"seen"===(null===a||void 0===a||null===(l=a.lastMessage)||void 0===l?void 0:l.status)?"#98999A":"#000"},children:[null===a||void 0===a||null===(d=a.lastMessage)||void 0===d?void 0:d.message,(0,M.jsx)(o.A,{variant:"body1",fontWeight:"400",color:"#000",fontSize:"0.8rem",children:null!==a&&void 0!==a&&null!==(c=a.lastMessage)&&void 0!==c&&c.message?"":"Tap to chat"})]})]})};return(0,M.jsxs)("div",{style:{position:"relative"},children:[(0,M.jsx)(x.A,{sx:{pl:1,background:"#F8F8FC",borderRadius:"10px",boxShadow:0,cursor:"pointer"},onClick:()=>n(!0),children:(0,M.jsxs)(p.Ay,{container:!0,spacing:2,children:[(0,M.jsxs)(p.Ay,{item:!0,xs:2,sx:{display:"flex",justifyContent:"center",alignItems:"center",position:"relative"},children:[(0,M.jsx)(l.A,{src:"Virtual_Assistant"===(null===a||void 0===a?void 0:a.role)?y.A.ai:null===a||void 0===a?void 0:a.dp,alt:"logo",style:{width:"2.5rem",height:"2.5rem",borderRadius:"50%",marginLeft:"0.8rem"}}),"1-1"===(null===a||void 0===a?void 0:a.chatType)&&0!==(null===a||void 0===a?void 0:a.activeParticipants.length)&&"offline"!==(null===a||void 0===a?void 0:a.activeParticipants[0].activity)?(0,M.jsx)(B.A,{sx:{color:"green",fontSize:"1rem",position:"absolute",bottom:"10px",right:"-7px"}}):null]}),(0,M.jsxs)(p.Ay,{item:!0,xs:8,sx:{mt:1},children:[(0,M.jsx)(o.A,{fontWeight:"500",gutterBottom:!0,children:(0,h.r0)(null===a||void 0===a?void 0:a.name)}),"Deleted User"===(null===a||void 0===a?void 0:a.name)?(0,M.jsx)(s.A,{sx:{p:1}}):(0,M.jsx)(c,{})]}),(0,M.jsx)(p.Ay,{item:!0,xs:2,sx:{display:"flex",justifyContent:"center",alignItems:"center"},children:(0,M.jsx)(o.A,{sx:{background:"#3b3f76",color:"#fff",borderRadius:"50%",width:"1rem",height:"1rem",border:"1px solid #3B3F76",fontSize:"11px",textAlign:"center"},children:null===a||void 0===a?void 0:a.unseenMessages})}),(0,M.jsx)(p.Ay,{item:!0,xs:12,sx:{position:"absolute",right:"10px",top:"-2rem"},children:(0,M.jsx)(o.A,{fontWeight:"500",sx:{background:"#fff",p:.5,borderRadius:"10px",color:"counsellor"===(null===a||void 0===a?void 0:a.role)?"#3B3F76":"processCoordinator"===(null===a||void 0===a?void 0:a.role)?"#569228":"#FEB853",fontSize:"14px"},children:null!==a&&void 0!==a&&a.role?(0,h.AZ)(null===a||void 0===a?void 0:a.role):null===a||void 0===a?void 0:a.role})})]})}),t?(0,M.jsx)(z,{open:t,setOpen:n,id:null===e||void 0===e||null===(i=e.data)||void 0===i?void 0:i._id,type:"advisors"}):null]})},H=()=>{var e,i,t;const n=(0,v.G)((e=>e.chats)),r=null===(l=null===n||void 0===n||null===(e=n.data)||void 0===e?void 0:e.advisors)||void 0===l?void 0:l.filter((e=>{var i;return!(null!==e&&void 0!==e&&null!==(i=e.participants)&&void 0!==i&&i.some((e=>"Virtual_Assistant"===e.role)))}));var l;return(0,M.jsx)(s.A,{sx:{overflowY:"scroll",height:"450px","&::-webkit-scrollbar":{width:"12px"},"&::-webkit-scrollbar-thumb":{backgroundColor:"#fff",borderRadius:"8px"},"&::-webkit-scrollbar-track":{backgroundColor:"#fff"},width:"100%",mt:1},children:(0,M.jsx)(p.Ay,{container:!0,spacing:2,sx:{mt:0},children:(null===n||void 0===n||null===(i=n.data)||void 0===i||null===(t=i.advisors)||void 0===t?void 0:t.length)>0?null===r||void 0===r?void 0:r.map(((e,i)=>(0,M.jsx)(p.Ay,{item:!0,xs:12,children:(0,M.jsx)(P,{data:e})},i))):(0,M.jsx)(s.A,{sx:{height:"5rem",borderRadius:"20px",display:"flex",justifyContent:"center",alignItems:"center",width:"100%"},children:(0,M.jsx)(o.A,{color:"#3B3F76",children:"Start a new chat"})})})})},O=e=>{var i;const[t,n]=(0,u.useState)(!1),r=(0,v.G)((e=>e.sharedInfo)),d=null===r||void 0===r?void 0:r.data,a=d?((e,i)=>{let t={dp:"",name:"",unseenMessages:0,activeParticipants:[],chatType:"1-1",lastMessage:void 0},n=e.participants.find((e=>e._id===i._id)),s=e.participants.filter((e=>e._id!==i._id));var r,l,o,d;e.participants.length<=2?(t.name=(null===s||void 0===s?void 0:s.length)>0?(null!==s&&void 0!==s&&null!==(r=s[0])&&void 0!==r&&r.firstName?null===s||void 0===s||null===(l=s[0])||void 0===l?void 0:l.firstName:"user")+(null!==s&&void 0!==s&&null!==(o=s[0])&&void 0!==o&&o.lastName?" "+(null===s||void 0===s||null===(d=s[0])||void 0===d?void 0:d.lastName):""):"Deleted User",t.dp=(null===s||void 0===s?void 0:s.length)>0?null===s||void 0===s?void 0:s[0].displayPicSrc:""):(t.chatType="group",t.name="Group Name");return t.unseenMessages=e.unSeenMessages.filter((e=>{var t,n;return(null===e||void 0===e||null===(t=e.message)||void 0===t||null===(n=t.sender)||void 0===n?void 0:n._id)!==(null===i||void 0===i?void 0:i._id)})).filter((e=>!e.seen.some((e=>e===i._id)))).length,e.lastMessage&&n&&(t.lastMessage=((e,i)=>{var t,n,s;let r={sender:(null===(t=e.lastMessage)||void 0===t?void 0:t.sender)===i._id?"current":"others",message:null!==(n=e.lastMessage)&&void 0!==n&&n.content?null===(s=e.lastMessage)||void 0===s?void 0:s.content:"",status:"seen"};if("current"===r.sender)r.status=-1===e.unSeenMessages.findIndex((i=>{var t;return i.message._id===(null===(t=e.lastMessage)||void 0===t?void 0:t._id)}))?"seen":"unseen";else{let t=e.unSeenMessages.findIndex((i=>{var t;return i.message._id===(null===(t=e.lastMessage)||void 0===t?void 0:t._id)}));r.status=-1===t?"seen":-1===e.unSeenMessages[t].seen.findIndex((e=>e===i._id))?"unseen":"seen"}return r})(e,n),t.activeParticipants=((e,i)=>{let t=e.participants.filter((e=>"inchat"===e.activity&&e._id!==i._id)),n=e.participants.filter((e=>"online"===e.activity&&e._id!==i._id));return[...e.participants.filter((e=>"typing"===e.activity&&e._id!==i._id)),...t,...n]})(e,n)),t})(e.data,d):null,c=()=>{var e,i,t,n,r,l,d,c;return(0,M.jsxs)("div",{style:{display:"flex",gap:"8px",width:"100%"},children:["current"===(null===a||void 0===a||null===(e=a.lastMessage)||void 0===e?void 0:e.sender)?(0,M.jsx)(M.Fragment,{children:"seen"===(null===a||void 0===a||null===(i=a.lastMessage)||void 0===i?void 0:i.status)?(0,M.jsx)(s.A,{sx:{display:"flex"},children:(0,M.jsx)(T.A,{sx:{color:"#2196f3",fontSize:"1rem"}})}):(0,M.jsx)(s.A,{sx:{display:"flex"},children:(0,M.jsx)(T.A,{sx:{color:"gray",fontSize:"1rem"}})})}):null,(0,M.jsxs)(o.A,{sx:{fontSize:"12px",width:"200px",height:"2rem",textOverflow:"ellipsis",whiteSpace:"nowrap",overflow:"hidden",fontWeight:"current"===(null===a||void 0===a||null===(t=a.lastMessage)||void 0===t?void 0:t.sender)||"seen"===(null===a||void 0===a||null===(n=a.lastMessage)||void 0===n?void 0:n.status)?"300":"400",color:"current"===(null===a||void 0===a||null===(r=a.lastMessage)||void 0===r?void 0:r.sender)||"seen"===(null===a||void 0===a||null===(l=a.lastMessage)||void 0===l?void 0:l.status)?"#98999A":"#000"},children:[null===a||void 0===a||null===(d=a.lastMessage)||void 0===d?void 0:d.message,(0,M.jsx)(o.A,{variant:"body1",fontWeight:"400",color:"#000",fontSize:"0.8rem",children:null!==a&&void 0!==a&&null!==(c=a.lastMessage)&&void 0!==c&&c.message?"":"Tap to chat"})]})]})};return(0,M.jsxs)("div",{children:[(0,M.jsx)(x.A,{sx:{p:.5,background:"#F8F8FC",borderRadius:"10px",boxShadow:0,cursor:"pointer"},onClick:()=>n(!0),children:(0,M.jsxs)(p.Ay,{container:!0,spacing:2,children:[(0,M.jsxs)(p.Ay,{item:!0,xs:2,sx:{display:"flex",justifyContent:"center",alignItems:"center",position:"relative"},children:[(0,M.jsx)(l.A,{src:null===a||void 0===a?void 0:a.dp,alt:"logo",style:{width:"2.5rem",height:"2.5rem",borderRadius:"50%",marginLeft:"0.8rem"}}),"1-1"===(null===a||void 0===a?void 0:a.chatType)&&0!==(null===a||void 0===a?void 0:a.activeParticipants.length)&&"offline"!==(null===a||void 0===a?void 0:a.activeParticipants[0].activity)?(0,M.jsx)(B.A,{sx:{color:"green",fontSize:"1rem",position:"absolute",bottom:"10px",right:"-7px"}}):null]}),(0,M.jsxs)(p.Ay,{item:!0,xs:8,children:[(0,M.jsx)(o.A,{fontWeight:"500",gutterBottom:!0,children:(0,h.r0)(null===a||void 0===a?void 0:a.name)}),"Deleted User"===(null===a||void 0===a?void 0:a.name)?(0,M.jsx)(s.A,{sx:{p:1}}):(0,M.jsx)(c,{})]}),(0,M.jsx)(p.Ay,{item:!0,xs:2,sx:{display:"flex",justifyContent:"center",alignItems:"center"},children:(0,M.jsx)(o.A,{sx:{background:"#3B3F76",color:"#fff",borderRadius:"50%",width:"1rem",height:"1rem",border:"1px solid #3B3F76",fontSize:"11px",textAlign:"center"},children:null===a||void 0===a?void 0:a.unseenMessages})})]})}),t?(0,M.jsx)(z,{open:t,setOpen:n,id:null===e||void 0===e||null===(i=e.data)||void 0===i?void 0:i._id,type:"community"}):null]})},D=()=>{var e,i,t,n;const r=(0,v.G)((e=>e.chats));return(0,M.jsx)(s.A,{sx:{overflowY:"scroll",height:"450px","&::-webkit-scrollbar":{width:"12px"},"&::-webkit-scrollbar-thumb":{backgroundColor:"#fff",borderRadius:"8px"},"&::-webkit-scrollbar-track":{backgroundColor:"#fff"},width:"100%",mt:2},children:(0,M.jsx)(p.Ay,{container:!0,spacing:2,sx:{mt:0},children:(null===r||void 0===r||null===(e=r.data)||void 0===e||null===(i=e.community)||void 0===i?void 0:i.length)>0?null===r||void 0===r||null===(t=r.data)||void 0===t||null===(n=t.community)||void 0===n?void 0:n.map(((e,i)=>(0,M.jsx)(p.Ay,{item:!0,xs:12,children:(0,M.jsx)(O,{data:e})},i))):(0,M.jsx)(s.A,{sx:{height:"5rem",borderRadius:"20px",display:"flex",justifyContent:"center",alignItems:"center",width:"100%"},children:(0,M.jsx)(o.A,{color:"#3B3F76",children:"Start a new chat"})})})})};var E=t(22505),G=t(84311),W=t(8064),L=t(51787),V=t(66360),U=t(57566);const q=u.forwardRef((function(e,i){return(0,M.jsx)(n.A,{direction:"up",ref:i,...e})})),Y=e=>{let{eventHandler:i,options:t,friends:n}=e;return(0,M.jsxs)(d.A,{spacing:1,className:"chat-container-messenger1",sx:{mt:2,height:"480px"},children:[(0,M.jsx)(o.A,{textAlign:"center",fontWeight:"600",children:"New Chat"}),(0,M.jsx)(m.A,{size:"small",fullWidth:!0,onChange:e=>i({name:"handleChange",data:e}),id:"outlined-basic",placeholder:"Search",variant:"outlined",autoComplete:"false",sx:{"& .MuiOutlinedInput-root":{borderRadius:"10px"}},InputProps:{startAdornment:(0,M.jsx)(L.A,{position:"start",children:(0,M.jsx)(V.A,{})})}}),(0,M.jsx)(s.A,{sx:{height:"420px",overflowY:"scroll",p:1},children:t.map(((e,t)=>{var s;return(0,M.jsxs)(p.Ay,{container:!0,spacing:3,onClick:()=>i({name:"select",data:e}),sx:{p:0},children:[(0,M.jsx)(p.Ay,{item:!0,xs:2,sx:{display:"flex",justifyContent:"center",alignItems:"center"},children:(0,M.jsx)(l.A,{src:e.displayPicSrc,alt:"profile",style:{width:"2rem",height:"2rem",borderRadius:"50%"}})}),(0,M.jsx)(p.Ay,{item:!0,xs:8,children:(0,M.jsx)("h5",{children:(0,h.r0)(e.firstName)+" "+(0,h.r0)(null===e||void 0===e?void 0:e.lastName)})}),(0,M.jsx)(p.Ay,{item:!0,xs:2,sx:{display:"flex",justifyContent:"center",alignItems:"center"},children:null!==(s=n.current)&&void 0!==s&&s.find((i=>i._id===e._id))?(0,M.jsx)("span",{style:{color:"rgb(255, 117, 26)"},children:"Friend"}):(0,M.jsx)(U.A,{sx:{fontSize:"1.2rem",color:"teal"}})})]},t)}))})]})},K=e=>{var i,t;let{open:n,setOpen:r}=e;const[l,o]=(0,u.useState)(null),[d,a]=(0,u.useState)(!1),[p,x]=(0,u.useState)([]),m=(0,v.G)((e=>e.sharedInfo)),y=(0,v.G)((e=>e.chats)),j=[...y.data.advisors,...y.data.community],b=(0,u.useRef)(null!==(i=m.data)&&void 0!==i&&i._id?(0,h.M7)(j,null===(t=m.data)||void 0===t?void 0:t._id):[]),w=(0,v.j)();return(0,M.jsx)("div",{children:(0,M.jsx)(c.A,{open:n,sx:{right:"0",left:{md:"45%",xs:"0",lg:"68%"},top:{md:"10px",xs:"0",lg:"25px"}},PaperProps:{style:{borderRadius:"1rem",padding:"1rem",width:"410px",height:"550px"}},TransitionComponent:q,keepMounted:!0,onClose:()=>r(!1),"aria-describedby":"alert-dialog-slide-description",children:d?(0,M.jsx)("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",height:"300px"},children:(0,M.jsx)(g.A,{})}):(0,M.jsxs)(M.Fragment,{children:[(0,M.jsx)(s.A,{sx:{display:"flex",alignItems:"center",justifyContent:"center"},children:(0,M.jsx)(f.A,{onClick:()=>r(!1),sx:{width:"2rem",height:"2rem"}})}),(0,M.jsx)(Y,{searchTerm:l,eventHandler:async e=>{switch(e.name){case"handleChange":""!==e.data.target.value&&(o(e.data.target.value),(async e=>{const i=await(0,A.iT)(e);var t;i&&void 0!==i.data&&x(null===i||void 0===i||null===(t=i.data)||void 0===t?void 0:t.filter((e=>{var i;return e._id!==(null===(i=m.data)||void 0===i?void 0:i._id)})))})(e.data.target.value.trim()));break;case"select":a(!0),a(!1),r(!1);const i=await(async e=>{try{const i=await(0,A.V4)(e);return i&&i.data,i.data}catch(i){}})(e.data._id);w((0,_.Nl)(i))}},options:p,friends:b})]})})})};var Z=t(47500),J=t(76040),Q=t(74802),X=t(86598),$=t(88446);const ee=u.forwardRef((function(e,i){return(0,M.jsx)(n.A,{direction:"up",ref:i,...e})})),ie=e=>{let{open:i,setOpen:t,id:n,type:r}=e;const x=(0,v.G)((e=>e.sharedInfo)),j=(0,u.useRef)([]),[C,k]=(0,u.useState)(!1),I=(0,v.G)((e=>e.messages)),[R,N]=(0,u.useState)([]),[z,T]=(0,u.useState)(null),[B,P]=(0,u.useState)(!1),[H,O]=(0,u.useState)(""),[D,E]=(0,u.useState)(""),G=(0,v.G)((e=>{let i=e.chats;return"advisors"===r?i.data.advisors.find((e=>e._id===n)):i.data.community.find((e=>e._id===n))})),W=(0,v.j)(),L=null===G||void 0===G?void 0:G.participants.find((e=>{var i;return e._id!==(null===x||void 0===x||null===(i=x.data)||void 0===i?void 0:i._id)})),V=async()=>{const e=await(0,A.de)(n);if(e.success&&(W((0,_.wi)(e.data)),x.data&&x.data._id&&Object.values(x.data).every((e=>void 0!==typeof e)))){let i={action:"seen",sender:{...x.data,userType:"student"},recievers:null===G||void 0===G?void 0:G.participants.filter((e=>{var i;return e._id!==(null===(i=x.data)||void 0===i?void 0:i._id)})),data:e.data};w.A.emit("trigger",i)}},U=async e=>{let i;switch(e.name){case"send":const s=new FormData;s.append("content",e.data),s.append("chatId",n);try{if(e.data.trim()){const i=await(0,A._N)(s);E("Ava is typing"),i.data.success?(W((0,_.wi)(i.data.data.chat)),W((0,b.tj)(i.data.data.message)),N([])):console.error("Failed to send message or upload files.");const t=await(0,A.G5)({content:e.data,chatId:n});E(""),t.data.success?(W((0,_.wi)(t.data.data.chat)),W((0,b.tj)(t.data.data.message))):console.error("Failed to send message or upload files.")}}catch(t){console.error("Error during file upload or message sending:",t)}break;case"startTyping":i={action:"typing",sender:{...x.data,userType:"student"},recievers:null===G||void 0===G?void 0:G.participants.filter((e=>{var i;return e._id!=(null===(i=x.data)||void 0===i?void 0:i._id)})),data:"start"}}};(0,u.useEffect)((()=>{(async()=>{try{k(!0);const e=await(0,A.qH)(n);if(e){let i=e.data.map((e=>({...e,type:"normal"})));i.reverse(),W((0,b.bq)({requestStatus:"initiated",responseStatus:"recieved",haveAnIssue:!1,issue:"",data:i})),0!=(null===G||void 0===G?void 0:G.unSeenMessages.filter((e=>{var i;return e.message.sender._id!==(null===(i=x.data)||void 0===i?void 0:i._id)})).filter((e=>!e.seen.find((e=>{var i;return e===(null===(i=x.data)||void 0===i?void 0:i._id)})))).length)&&await V()}k(!1)}catch(e){k(!1)}})()}),[]),j.current=G&&x.data?((e,i,t)=>{let n=i.participants.filter((e=>e._id!=t._id)),s=[],r=[];e.reverse(),e.forEach((e=>{var l;if((null===(l=e.sender)||void 0===l?void 0:l._id)==t._id)if(0!=n.length){if(0==i.unSeenMessages.length?0!=n.length&&(r=[...n]):r=i.unSeenMessages.find((i=>i.message._id==e._id))?n.filter((t=>{var n;return null===(n=i.unSeenMessages.find((i=>i.message._id==e._id)))||void 0===n?void 0:n.seen.find((e=>e==t._id))})):[...n],0!=r.length){let t=r.reduce(((e,i)=>e+i.firstName+" , "),"Seen by ");s.push({_id:e._id+"_seen",type:"seen",content:t.substring(0,t.length-3),chat:i._id})}s.push(e),n=n.filter((e=>!r.find((i=>i._id==e._id))))}else s.push(e);else s.push(e)})),s.reverse();let l=i.participants.filter((e=>"typing"==e.activity));if(0!=l.length){let e=l.reduce(((e,i)=>i.firstName+" , "),"");s.push({_id:i._id+"_typing",type:"typing",content:e.substring(0,e.length-3)+(1==l.length?" is typing":" are typing"),chat:i._id,sender:{displayPicSrc:"",firstName:"",lastName:"",email:"",_id:i._id+"_typing",userType:""}})}return s})([...I.data],G,x.data):[];const q=e=>(0,M.jsx)("div",{style:{background:"#F8F8FC",padding:"0.5rem",borderRadius:"0.8rem",position:"relative"},children:(0,M.jsxs)(d.A,{direction:"row",spacing:2,alignItems:"center",justifyContent:"space-between",children:[(0,M.jsxs)(s.A,{sx:{display:"flex",gap:"1rem",alignItems:"center"},children:[(0,M.jsx)(l.A,{src:"Virtual_Assistant"===(null===L||void 0===L?void 0:L.role)?y.A.ai:null===L||void 0===L?void 0:L.displayPicSrc,alt:"profile",sx:{width:"3rem",height:"3rem",borderRadius:"50%"}}),(0,M.jsx)(o.A,{fontWeight:"500",sx:{position:"absolute",right:"10px",top:"-1rem",background:"#fff",p:1,borderRadius:"10px",color:"counsellor"===(null===L||void 0===L?void 0:L.role)?"#3B3F76":"processCoordinator"===(null===L||void 0===L?void 0:L.role)?"#569228":"#FEB853",fontSize:"14px"},children:null!==L&&void 0!==L&&L.role?(0,h.AZ)(null===L||void 0===L?void 0:L.role):null===L||void 0===L?void 0:L.role}),(0,M.jsx)(s.A,{children:null!==L&&void 0!==L&&L.firstName||null!==L&&void 0!==L&&L.lastName?(0,M.jsxs)(o.A,{fontWeight:"500",children:[(0,h.r0)(null===L||void 0===L?void 0:L.firstName),"\xa0",(0,h.r0)(null===L||void 0===L?void 0:L.lastName)]}):(0,M.jsx)(o.A,{children:"User"})})]}),(0,M.jsx)(s.A,{sx:{float:"right"},children:(0,M.jsx)(a.A,{sx:{textTransform:"none",color:"#3b3f76",float:"right"},onClick:()=>e.eventHandler({name:"block",data:{action:"block",id:null===L||void 0===L?void 0:L._id}}),children:L&&"Virtual_Assistant"!==(null===L||void 0===L?void 0:L.role)&&"Block"})})]})}),Y=e=>{const i=(0,u.useRef)(null),t=(0,u.useRef)(null),[n,r]=(0,u.useState)(!0);return(0,u.useEffect)((()=>{var e;n&&(null===(e=i.current)||void 0===e||e.scrollIntoView({behavior:"auto"}))}),[j.current]),(0,u.useEffect)((()=>{var e;null===(e=i.current)||void 0===e||e.scrollIntoView({behavior:"auto"})}),[]),(0,M.jsx)(s.A,{ref:t,onScroll:()=>{if(t.current){const{scrollTop:e,scrollHeight:i,clientHeight:n}=t.current;r(i-e-n<=5)}},sx:{overflowY:"scroll",mt:3,height:"390px","&::-webkit-scrollbar":{width:"12px"},"&::-webkit-scrollbar-thumb":{backgroundColor:"transparent",borderRadius:"8px"}},children:C?(0,M.jsx)(s.A,{sx:{display:"flex",justifyContent:"center",alignItems:"center",height:"300px"},children:(0,M.jsx)(g.A,{})}):(0,M.jsx)("div",{className:"chat-container",children:j.current.length>0?(0,M.jsxs)(M.Fragment,{children:[j.current.map((e=>{var i,t,n,s,r,o,d,a,c;return(0,M.jsx)(M.Fragment,{children:"seen"!==e.type&&"typing"!==e.type?(0,M.jsxs)("div",{className:"message ".concat((null===e||void 0===e||null===(i=e.sender)||void 0===i?void 0:i._id)===(null===(t=x.data)||void 0===t?void 0:t._id)?"sent":"received"),children:[(0,M.jsx)(F,{content:e.content}),null!==e&&void 0!==e&&null!==(n=e.document)&&void 0!==n&&null!==(s=n.data)&&void 0!==s&&s.preview_url?(0,M.jsx)("iframe",{src:null===e||void 0===e||null===(r=e.document)||void 0===r||null===(o=r.data)||void 0===o?void 0:o.preview_url,title:"preview",style:{border:"none",width:"150px",height:"150px",objectFit:"contain"}}):"",(0,M.jsx)(l.A,{src:null===(d=e.sender)||void 0===d?void 0:d.displayPicSrc,alt:"",sx:(null===e||void 0===e||null===(a=e.sender)||void 0===a?void 0:a._id)===(null===(c=x.data)||void 0===c?void 0:c._id)?{width:"1.5rem",height:"1.5rem",borderRadius:"50%",position:"absolute",top:"-12px",right:0}:{width:"1.5rem",height:"1.5rem",borderRadius:"50%",position:"absolute",top:"-12px",left:0}})]},e._id):(0,M.jsx)(M.Fragment,{children:(0,M.jsx)("div",{className:"seenMsg",children:e.content},e._id)})})})),D&&(0,M.jsx)(o.A,{sx:{textAlign:"right",fontSize:"13px",color:"#3b3f76",marginTop:"8px"},children:D}),(0,M.jsx)("div",{ref:i})]}):(0,M.jsxs)(s.A,{sx:{display:"flex",flexDirection:"column",gap:"8px"},children:[(0,M.jsxs)(o.A,{sx:{fontSize:"14px"},children:["Hi, How can I help you ? Here are few questions"," "]}),["Top courses in USA?","Best universities in Computer Science ?"].map(((i,t)=>(0,M.jsx)($.A,{sx:{fontSize:"14px",textDecoration:"none",cursor:"pointer"},onClick:()=>e.eventHandler({name:"send",data:i}),children:i},t)))]})})})},K=e=>{const[i,t]=(0,u.useState)(""),[n,s]=(0,u.useState)(!1),r=((0,u.useRef)(null),async()=>{try{""!==i.trim()||R&&R.length>0?(s(!0),await e.eventHandler({name:"send",data:i})):console.log("No content or files to send.")}catch(t){console.error("Error while sending:",t)}finally{s(!1)}});return(0,M.jsx)(M.Fragment,{children:L&&(0,M.jsxs)("div",{style:{position:"relative"},children:[(null===R||void 0===R?void 0:R.length)>0&&(0,M.jsx)("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",position:"absolute",top:"-44px",right:"35%"},children:(0,M.jsxs)("div",{style:{width:"fitContent"},children:[(0,M.jsx)(o.A,{fontSize:"0.9rem",children:"Selected files:"}),(0,M.jsx)("ul",{style:{listStyle:"none",padding:0,margin:0},children:R.map(((e,i)=>(0,M.jsxs)("li",{style:{fontSize:"12px",display:"flex"},children:[e.name,(0,M.jsx)(S.A,{onClick:()=>(e=>{const i=[...R];i.splice(e,1),N(i)})(i),sx:{fontSize:"1rem",cursor:"pointer"}})]},i)))})]})}),B?(0,M.jsx)("div",{className:"replyDiv",children:(0,M.jsxs)("h5",{children:["reply to:- ",H]})}):"",(0,M.jsxs)(p.Ay,{container:!0,sx:{background:"#F8F8FC",padding:"0.5rem",borderRadius:"0.8rem"},children:[(0,M.jsx)(p.Ay,{item:!0,xs:9.5,children:(0,M.jsx)(m.A,{variant:"outlined",size:"small",onFocus:()=>e.eventHandler({name:"startTyping"}),onBlur:()=>e.eventHandler({name:"stopTyping"}),multiline:!0,rows:2,fullWidth:!0,placeholder:"Type your message...",value:i,sx:{"& .MuiOutlinedInput-notchedOutline":{border:0,"&:Focus":{border:0}},"& .Mui-focused .MuiOutlinedInput-notchedOutline":{border:"none !important"}},onChange:e=>t(e.target.value),onKeyDown:e=>{"Enter"!==e.key||e.shiftKey||""===i.trim()||(e.preventDefault(),r())}})}),(0,M.jsx)(p.Ay,{item:!0,xs:1.5,sx:{display:"flex",justifyContent:"center",alignItems:"center",background:"#fff",borderRadius:"6px"},children:n?(0,M.jsx)("img",{src:y.A.standardLoader,alt:"loader",style:{width:"1rem"}}):(0,M.jsx)("img",{src:y.A.sendIcon,alt:"sendIcon",style:{width:"2rem",height:"2rem"},onClick:r})})]})]})})};return(0,M.jsx)("div",{children:(0,M.jsxs)(c.A,{open:i,sx:{right:"0",left:{md:"45%",xs:"0",lg:"68%"},top:{md:"10px",xs:"0",lg:"25px"}},PaperProps:{style:{borderRadius:"1rem",padding:"1rem",width:"410px",height:"582px"}},TransitionComponent:ee,keepMounted:!0,onClose:()=>t(!1),"aria-describedby":"alert-dialog-slide-description",children:[(0,M.jsx)(s.A,{sx:{display:"flex",alignItems:"center",justifyContent:"center"},children:(0,M.jsx)(f.A,{sx:{position:"absolute",top:0,color:"#0F0F0F",fontSize:"2rem",cursor:"pointer",display:"flex",justifyContent:"center",alignItems:"center"},onClick:()=>t(!1)})}),(0,M.jsxs)(s.A,{sx:{mt:3},children:[(0,M.jsx)(q,{eventHandler:U}),(0,M.jsx)(Y,{eventHandler:U}),(0,M.jsx)(K,{eventHandler:U})]})]})})},te=e=>{var i,t;const[n,s]=(0,u.useState)(!1),[r,l]=(0,u.useState)(!1),o=(0,v.j)(),[d,a]=(0,u.useState)(null),c=(0,v.G)((e=>e.userAuthStatus)),p=e=>{a(e)},x=()=>{a(null)},h=(0,v.G)((e=>e.chats)),g=(e=>{for(const t of e){var i;if(null===t||void 0===t||null===(i=t.participants)||void 0===i?void 0:i.find((e=>"Virtual_Assistant"===e.role)))return t}return null})(null===h||void 0===h||null===(i=h.data)||void 0===i?void 0:i.advisors);return(0,M.jsxs)("div",{style:{position:"fixed",bottom:16,right:16,zIndex:1},children:[(0,M.jsxs)(Z.A,{ariaLabel:"Custom SpeedDial",icon:n?(0,M.jsx)(Q.A,{style:{color:"white",fontSize:"28px"}}):(0,M.jsx)(X.A,{style:{color:"white",fontSize:"28px"}}),onClick:()=>{s((e=>!e))},open:n,direction:"up",FabProps:{style:{backgroundColor:"#3b3f76",color:"white"}},children:[(0,M.jsx)(J.A,{icon:(0,M.jsx)("img",{style:{width:"3rem",height:"3rem",cursor:"pointer"},src:y.A.chaticon,alt:"chat icon"}),tooltipOpen:"chat"===d,tooltipTitle:(0,M.jsx)("div",{style:{width:"120px",textAlign:"center"},children:"Chat with us"}),onClick:()=>e.setOpen(!0),onMouseEnter:()=>p("chat"),onMouseLeave:x}),(0,M.jsx)(J.A,{icon:(0,M.jsx)("img",{style:{width:"1.7rem",height:"1.7rem",cursor:"pointer",filter:"invert(1)"},src:y.A.ai,alt:"AI chat icon"}),FabProps:{style:{backgroundColor:"#3b3f76",color:"white",width:"45px",height:"45px"}},tooltipOpen:"ai"===d,tooltipTitle:(0,M.jsx)("div",{style:{width:"120px",textAlign:"center"},children:"Chat with AI"}),onClick:()=>{var e;null!==(e=c.data)&&void 0!==e&&e.isAuthorized?l(!0):o((0,W.DE)({show:!0,data:{container:{name:"login",dimensions:{width:"800px",height:"70%",show:"none"}},type:"custom"}}))},onMouseEnter:()=>p("ai"),onMouseLeave:x})]}),null!==(t=c.data)&&void 0!==t&&t.isAuthorized&&r?(0,M.jsx)(ie,{open:r,setOpen:l,id:null===g||void 0===g?void 0:g._id,type:"advisors"}):null]})},ne=u.forwardRef((function(e,i){return(0,M.jsx)(n.A,{direction:"up",ref:i,...e})})),se=()=>{const e=(0,v.j)();return(0,M.jsxs)("div",{style:{background:"#EDF2F6",padding:"1.5rem",borderRadius:"10px",position:"relative"},children:[(0,M.jsxs)(s.A,{sx:{display:"flex",flexDirection:"column",alignItems:"start",justifyContent:"start",mb:2},children:[(0,M.jsxs)(r.A,{max:4,children:[(0,M.jsx)(l.A,{alt:"Remy Sharp",src:"/static/images/avatar/1.jpg"}),(0,M.jsx)(l.A,{alt:"Travis Howard",src:"/static/images/avatar/2.jpg"}),(0,M.jsx)(l.A,{alt:"Cindy Baker",src:"/static/images/avatar/3.jpg"}),(0,M.jsx)(l.A,{alt:"Agnes Walker",src:"/static/images/avatar/4.jpg"}),(0,M.jsx)(l.A,{alt:"Trevor Henderson",src:"/static/images/avatar/5.jpg"})]}),(0,M.jsx)(o.A,{color:"#3B3F76",fontWeight:"600",gutterBottom:!0,children:"Say goodbye to all your doubts !"}),(0,M.jsxs)(o.A,{color:"rgba(48, 51, 99, 0.5)",gutterBottom:!0,children:["As you say hello to our profound advisors !"," "]})]}),(0,M.jsxs)(s.A,{sx:{background:"#fff",p:2,borderRadius:"10px",position:"absolute",left:"20px",right:"20px",boxShadow:"2",display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center"},children:[(0,M.jsxs)(o.A,{gutterBottom:!0,children:["Login to start chat with"," ",(0,M.jsx)("span",{style:{color:"rgba(48, 51, 99, 0.5)"},children:"Students "}),"and ",(0,M.jsx)("span",{style:{color:"rgba(48, 51, 99, 0.5)"},children:"Advisors"}),"."]}),(0,M.jsx)(G.S,{width:"100px",handleSubmit:()=>{e((0,W.DE)({show:!0,data:{container:{name:"login",dimensions:{width:"800px",height:"70%",show:"none"}},type:"custom"}}))},children:"Login"})]})]})},re=()=>{var e;const i=(0,v.G)((e=>e.userAuthStatus)),[t,n]=(0,u.useState)(!1),[r,l]=(0,u.useState)(!1),o=()=>{const[e,i]=(0,u.useState)("advisors");return(0,M.jsxs)(d.A,{spacing:1,sx:{height:"480px",p:2,justifyContent:"center",alignItems:"center"},children:[(0,M.jsxs)(s.A,{sx:{display:"flex",justifyContent:"center",alignItems:"center",width:"80%",gap:"1rem"},children:[(0,M.jsx)(a.A,{onClick:()=>i("advisors"),sx:{borderBottom:"advisors"===e?"2px solid #3B3F76":0,color:"advisors"===e?"#3B3F76":"#3b3f7699",borderRadius:0,textTransform:"none",fontSize:"0.9rem"},children:"Advisors"}),(0,M.jsx)(a.A,{onClick:()=>i("community"),sx:{borderBottom:"community"===e?"2px solid #3B3F76":0,color:"community"===e?"#3B3F76":"#3b3f7699",textTransform:"none",borderRadius:0,fontSize:"0.9rem"},children:"Community"})]}),"advisors"===e?(0,M.jsx)(H,{}):"community"===e?(0,M.jsx)(D,{}):"",(0,M.jsx)("div",{style:{position:"absolute",bottom:"12px",right:"12px"},children:(0,M.jsx)("div",{onClick:()=>l(!0),style:{background:"#3B3F76",color:"#fff",height:"1rem",width:"1rem",borderRadius:"50%",padding:"0.2rem",cursor:"pointer"},children:(0,M.jsx)(E.A,{sx:{fontSize:"1rem"}})})})]})};return(0,M.jsx)("div",{children:(0,M.jsxs)("div",{children:[(0,M.jsx)(te,{setOpen:n}),(0,M.jsx)(c.A,{open:t,sx:{right:"0",left:{md:"45%",xs:"0",lg:"68%"},top:{md:"1%",xs:"0",lg:"5%"}},PaperProps:{style:{borderRadius:"1rem",padding:"1rem",width:"410px",height:"550px"}},TransitionComponent:ne,keepMounted:!0,onClose:()=>n(!1),"aria-describedby":"alert-dialog-slide-description",children:(0,M.jsxs)(s.A,{children:[(0,M.jsx)(s.A,{sx:{display:"flex",justifyContent:"center"},children:(0,M.jsx)(f.A,{onClick:()=>n(!1),sx:{position:"absolute",top:0,color:"#0F0F0F",fontSize:"2rem",cursor:"pointer",display:"flex",justifyContent:"center",alignItems:"center"}})}),null!==(e=i.data)&&void 0!==e&&e.isAuthorized?(0,M.jsx)(o,{}):(0,M.jsx)("div",{style:{display:"flex",flexDirection:"column",justifyContent:"center",height:"50vh"},children:(0,M.jsx)(se,{})})]})}),r?(0,M.jsx)(K,{open:r,setOpen:l}):""]})})}}}]);
//# sourceMappingURL=518.4c49f16b.chunk.js.map